

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>A Tutorial on Data Science through Movies &#8212; My Jupyter Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'CMSC320FinalProject_-_Spring_2023_4';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="#">
  
  
  
  
  
    <p class="title logo__title">My Jupyter Book</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1 current active">
                <a class="reference internal" href="#">
                    <h1><center>A Tutorial on Data Science through Movies</center></h1>
                </a>
            </li>
        </ul>
        
    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/CMSC320FinalProject_-_Spring_2023_4.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1><h1><center>A Tutorial on Data Science through Movies</center></h1></h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-a-class-anchor-id-intro-a">Introduction <a class="anchor" id="intro"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-collection-data-cleaning-a-class-anchor-id-datacollectandclean-a">Data Collection/Data Cleaning <a class="anchor" id="dataCollectAndClean"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#imports-for-data-collection-a-class-anchor-id-importdc-a">Imports for Data Collection  <a class="anchor" id="importDC"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-of-data-collection-a-class-anchor-id-overviewdata-a">Overview of Data Collection  <a class="anchor" id="overviewData"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#webscraping-from-wikipedia-a-class-anchor-id-wikiscrape-a">Webscraping from Wikipedia <a class="anchor" id="wikiScrape"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pulling-from-the-omdb-api-a-class-anchor-id-omdbapi-a">Pulling from the OMDB API  <a class="anchor" id="omdbAPI"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-our-appended-dataframe">Creating our Appended DataFrame</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleaning-organizing-relavent-information-addressing-missing-data-a-class-anchor-id-cleanprocess-a">Data Cleaning: Organizing Relavent Information &amp; Addressing Missing Data  <a class="anchor" id="cleanProcess"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#organizing-relavent-information">Organizing Relavent Information</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-data">Missing Data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-tmdb-api-a-class-anchor-id-tmdbapi-a">Using the TMDB API  <a class="anchor" id="tmdbAPI"></a></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exploratory-data-analysis-and-visualization-a-class-anchor-id-dataviz-a">Exploratory Data Analysis and Visualization  <a class="anchor" id="dataViz"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-visualizations-a-class-anchor-id-initialviz-a">Initial Visualizations  <a class="anchor" id="initialViz"></a></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-analysis-hypothesis-testing-ml-a-class-anchor-id-ml-a">Model: Analysis, Hypothesis Testing, &amp; ML  <a class="anchor" id="ml"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#preliminary-exploration-of-data-for-the-model-a-class-anchor-id-preliminary-a">Preliminary Exploration of Data for the Model  <a class="anchor" id="preliminary"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-importance-a-class-anchor-id-feature-a">Feature Importance  <a class="anchor" id="feature"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#k-nearest-neighbors-a-class-anchor-id-knn-a">K Nearest Neighbors  <a class="anchor" id="knn"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest-classifier-a-class-anchor-id-rfc-a">Random Forest Classifier  <a class="anchor" id="rfc"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#logistic-regression-classification-a-class-anchor-id-logistic-a">Logistic Regression Classification  <a class="anchor" id="logistic"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#movie-recommender-a-class-anchor-id-movierec-a">Movie Recommender  <a class="anchor" id="movieRec"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#movie-recommender-ii-a-class-anchor-id-movierec2-a">Movie Recommender II  <a class="anchor" id="movieRec2"></a></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation-insight-policy-decision-a-class-anchor-id-conclusion-a">Interpretation: Insight &amp; Policy Decision  <a class="anchor" id="conclusion"></a></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="h1-center-a-tutorial-on-data-science-through-movies-center-h1">
<h1><h1><center>A Tutorial on Data Science through Movies</center></h1><a class="headerlink" href="#h1-center-a-tutorial-on-data-science-through-movies-center-h1" title="Permalink to this heading">#</a></h1>
<blockquote>
<div><p>Collaborators: Archit Kambhamettu, Rohit Mukund, Saurabh Gadre, Vineeth Gohimukkula</p>
</div></blockquote>
<p><img alt="movieStartingPicture" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAAAeFBMVEUAAAD///8fHx8XFxdXV1fn5+eXl5dHR0f8/PwZGRkFBQXk5OSSkpJra2ukpKQ+Pj67u7tmZmby8vLBwcE1NTVNTU2MjIwODg4mJiZ3d3e3t7dBQUFubm7ExMQpKSkdHR2BgYGsrKxgYGDS0tLc3NwxMTHV1dWEhIQJStvgAAAEo0lEQVR4nO2b63arIBCFxURjzV1tLm3uadL3f8ND4oWBGYlGoOus5fwMyP4KWxjAesxZRIvlZj3/Un713KkPvGdM/gBAqPNYB44BJPVHrFwCIHUemTMASv0RP04A6tTVMbADoFFXx8ACgKLubz9VgrFFAKR+ZSzTjYFRAKS+f/yaxLoxMAcQpZQ6jy/sAjAGhgCidCq7LhVlWwwAxsAEAFL3vAMoRhaQxqAzAKHOYykqYAtIY9ANgFbnMRN1FlS5GIMOALXqPMCKd6LKxRi8C6BT97wNqDknyuPvqBMAV/8AzflDVQBYIEIWiL9D0EHtAVR1/r7PVA1ggVSn3h5AUT/unrPNRQWoTB6EmU69JQCtzmOj6Pul+ijWq7cBUNS90b4qGqsdcEHqHq3eGEBV57EQpdgCQfjdSL0ZAKHOOzQRFZZq4a2pegOAKN1hdU9eUVULNFd/CVCjzmMrKiELNFfXA+xr1XmAHRayQHN1DYCs/rFWmtdawPPmDdXrABT1aRqp877OAvNJY3USYL87KuqMXdU/UVggCDuoYwBKncdEBSgskMizTWt1BUBWj3dptWai5e5hgWTWWR0CyOo8PkEt1QI3rv5pQL0CiEJF3ZMyV2SBzJB6BUC8Sd5VVEIWMKVeAuyJhteRqIQsYEq9BCC2DloLGFPXAQAL3K2plwDUbA4sEGL1cV177wEQmxdggWRkTb0EYOgIobIAet+NqlcAeAxWTtQrADwGeyfqFQAag9iNugCgsxrr6gKgNq+zqy4A0ObKjTqrfwv4FtuBegnwU+Sc69EpXN4KgMOrRw0CFDvYeX6KPCvWnrMzgGKxGZa/jfMOyTSPmQU4PfUGYnnLVx+Y+9sFyGehE/g13xao90vWAG5ILkda+5YjKwD8pxy8x6AyFAsxKADylwCcONQngXYAcjl4iO9XdYYhCJw2eBtYTnRcvIIVlD1uCZA/txGmFwfsR/gmBERyCk7FqbwGniPg3K4EKPYd07JeIvbG0otALBhLWH4mOggk9+X8ggHK09RL/ufuxX57CNsnTp0HsIMS4jwDGgt3UAVQoh93s8UKGFC6ZU2Io6AzbJ/YXl30HVQB1Lk+hM8TDoObF2p7JXcQ3n4KgORA6c9h+1cidYfrdUQ0MYMNTAnACoD9EI/Hd9g+cfEiXcSfcPnoRQdBAJZgi8PFgdogZ9Dhd6KD4NxKdZAEgD160L5BvIPA5o28lpCuiH8JfQVANeI5AEFMMUtYTnTQZgzKCQe9BHAQPUAP0AP0AD3A/w/g+6/rWAUYJTtylXMHwDM1IlNyCsCiFc5VnALwbInIVpwC8Ixfc8XqBIAlRM7tFIBn3bfX1a0CsOi3/RtpFIBvbkavn7AKIE4Y/wyAJdQFpEsAxlJym+sQgEWn5ma0AsCS5g1ZATjjcwiXAONWrRgHiCbtVkbTAK1zA7MAybb1XGwU4OuN/NAgQPBWTm0OQD2Fdgxwpz6cdQfQZu61AZBqviZ0ABDQd77OANpmIKYBOu3LTAB0jR6gB+gBeoAeoAfoAT4kAEcfrsDIJADiHyNtx1YCcD8Gz69WAEC0unXNsdqEv3x+3vAPpFBIvWSCqpcAAAAASUVORK5CYII=" /></p>
<section id="table-of-contents">
<h2>Table of Contents:<a class="headerlink" href="#table-of-contents" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><span class="xref myst">Introduction</span></p></li>
<li><p><span class="xref myst">1. Data Collection/Data Cleaning</span></p></li>
<li><p><span class="xref myst">Imports for Data Collection</span></p></li>
<li><p><span class="xref myst">Overview of Data Collection</span></p></li>
<li><p><span class="xref myst">Data Cleaning and Processing</span></p></li>
<li><p><span class="xref myst">Using the TMDB API</span></p></li>
<li><p><span class="xref myst">2. Exploratory Data Analysis and Visualization</span></p></li>
<li><p><span class="xref myst">Initial Visuals</span></p></li>
<li><p><span class="xref myst">3. Model: Analysis, Hypothesis Testing, &amp; ML</span></p></li>
<li><p><span class="xref myst">Preliminary Exploration for Model Use</span></p></li>
<li><p><span class="xref myst">Feature Importance</span></p></li>
<li><p><span class="xref myst">K Nearest Neighbors</span></p></li>
<li><p><span class="xref myst">Random Forest Classifier</span></p></li>
<li><p><span class="xref myst">Logistic Regression Classifier</span></p></li>
<li><p><span class="xref myst">Movie Recommender</span></p></li>
<li><p><span class="xref myst">Movie Recommender II</span></p></li>
<li><p><span class="xref myst">4. Interpretation: Insight &amp; Policy Decision</span></p></li>
</ul>
</section>
<section id="introduction-a-class-anchor-id-intro-a">
<h2>Introduction <a class="anchor" id="intro"></a><a class="headerlink" href="#introduction-a-class-anchor-id-intro-a" title="Permalink to this heading">#</a></h2>
<p>In an age where entertainment options are more abundant than ever, choosing the perfect movie to watch can be an impossible task. We’ve all been there: scrolling endlessly through Netflix and Hulu just to settle on a mediocre movie because you’re just too overwhelmed by the options. In the 80s, there were only about a hundred movies released per year. Now, there’s over 800 movies made per year in the US <a class="reference external" href="https://www.statista.com/statistics/187122/movie-releases-in-north-america-since-2001/">alone</a>! Luckily, we’ve used our knowledge about data science and machine learning to help you make the perfect choice.</p>
<p>The purpose of this project is not just to create a movie recommender, it is mainly to walk you through the <a class="reference external" href="https://www.knowledgehut.com/blog/data-science/what-is-data-science-life-cycle">data science lifecycle</a>. There are 5 main steps that data scientists follow. The first is data collection, which consists of looking for data that could be interesting to analyze based on a central inquiry. Next comes cleaning and processing the data so that it is in a usable form for analysis. The processed data is then visualized for better understanding of trends and spread. Once the data is analyzed and visualized, it is modelled through ML. Finally, the analyzed data and the results of the model drive new in sights on the central question and policy decisions can be made with greater certainty.</p>
<p>We hope you enjoy this journey into the world of data science and find our results intriguing!</p>
</section>
<section id="data-collection-data-cleaning-a-class-anchor-id-datacollectandclean-a">
<h2>Data Collection/Data Cleaning <a class="anchor" id="dataCollectAndClean"></a><a class="headerlink" href="#data-collection-data-cleaning-a-class-anchor-id-datacollectandclean-a" title="Permalink to this heading">#</a></h2>
<section id="imports-for-data-collection-a-class-anchor-id-importdc-a">
<h3>Imports for Data Collection  <a class="anchor" id="importDC"></a><a class="headerlink" href="#imports-for-data-collection-a-class-anchor-id-importdc-a" title="Permalink to this heading">#</a></h3>
<p>For this project, we imported many libraries that are instrumental in data science. These include <a class="reference external" href="https://pandas.pydata.org/">pandas</a>, <a class="reference external" href="https://numpy.org/">numpy</a>, and <a class="reference external" href="https://beautiful-soup-4.readthedocs.io/en/latest/#:~:text=Beautiful%20Soup%20is%20a%20Python,hours%20or%20days%20of%20work.">Beautiful Soup</a>, which makes it easy to pull data out of HTML files.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">html5lib</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="overview-of-data-collection-a-class-anchor-id-overviewdata-a">
<h3>Overview of Data Collection  <a class="anchor" id="overviewData"></a><a class="headerlink" href="#overview-of-data-collection-a-class-anchor-id-overviewdata-a" title="Permalink to this heading">#</a></h3>
<p>Data collection is the first step in the data science life cycle. To gather the data needed for this project, we scoured the web to look for sources that would give us the most amount of data in a simple format. To start, we looked at the <a class="reference external" href="https://www.imdb.com/chart/top/">IMDB Top 250</a> movies list which gave us the title of the movie and the imdb rating in a tabular format. However, we recognized that we would need more information if we were to do real data analysis on an abundance of factors. Also, we felt that 250 entries in a table would simply not be enough data points to train a model.</p>
<section id="webscraping-from-wikipedia-a-class-anchor-id-wikiscrape-a">
<h4>Webscraping from Wikipedia <a class="anchor" id="wikiScrape"></a><a class="headerlink" href="#webscraping-from-wikipedia-a-class-anchor-id-wikiscrape-a" title="Permalink to this heading">#</a></h4>
<p>So, we needed a comprehensive list of movies from the past decade sorted by year. We decided to do this by webscraping from Wikipedia, since this list is arranged by month and year, as well as giving us additional information on Production Company. This list is messy when scraped, but  proper data cleaning in combination with extraneous data from the two API’s will generate a list of clean data that supports thorough analysis.</p>
<p>We start by using the requests library to make a GET request to <a class="reference external" href="https://en.wikipedia.org/wiki/Lists_of_American_films">Wikipedia’s webpage for American movies by year</a>. Each year’s Wikipedia page is split into 5 different tables:</p>
<ol class="arabic simple">
<li><p>The top 10 movies of the year</p></li>
<li><p>Movies released in January through March</p></li>
<li><p>Movies released in April through June</p></li>
<li><p>Movies released in July through September</p></li>
<li><p>Movies released in October through December</p></li>
</ol>
<p>We want to pull all of the table tags out of the HTML using BeautifulSoup. Since all we are seeking is a list of movies in the year, we can ignore the first table. Once we have these tables, we can concetenate them together, making a table for each year, and then do one final concentation to get our complete data set</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># We can start by collecting one dataframe for each year, and then concatenating them together.</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="mi">2022</span><span class="p">):</span>
    <span class="c1"># First we pull this specific year&#39;s table of off wikipedia.</span>
    <span class="c1"># Wikipedia splits its tables between the following </span>
    <span class="c1"># 1) A top hits table</span>
    <span class="c1"># 2 -&gt; 5) January-March, April-June, July-September, October-December</span>
    
    <span class="c1"># We can use beautiful soup to grab each of these tables, and concatenate all of these together </span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;https://en.wikipedia.org/wiki/List_of_American_films_of_</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
    <span class="n">find_table</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">)</span>
    <span class="n">tables</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">find_table</span><span class="p">))</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">tables</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">tables</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">tables</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">tables</span><span class="p">[</span><span class="mi">5</span><span class="p">]])</span>
    <span class="c1"># Now, set the year to be this index</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
    <span class="n">dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We then concatenate all of these years together into one larger dataframe</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dfs</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Opening</th>
      <th>Opening.1</th>
      <th>Title</th>
      <th>Production company</th>
      <th>Cast and crew</th>
      <th>.mw-parser-output .tooltip-dotted{border-bottom:1px dotted;cursor:help}Ref.</th>
      <th>Ref.</th>
      <th>year</th>
      <th>Production Company</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>J A N U A R Y</td>
      <td>5.0</td>
      <td>If I Want to Whistle, I Whistle</td>
      <td>Film Movement</td>
      <td>Florin Șerban (director); George Piştereanu</td>
      <td>[2]</td>
      <td>NaN</td>
      <td>2011</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>J A N U A R Y</td>
      <td>5.0</td>
      <td>Phil Ochs: There but for Fortune</td>
      <td>First Run Features</td>
      <td>Kenneth Bowser (director)</td>
      <td>[3]</td>
      <td>NaN</td>
      <td>2011</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>J A N U A R Y</td>
      <td>7.0</td>
      <td>Season of the Witch</td>
      <td>Rogue Pictures / Relativity Media</td>
      <td>Dominic Sena (director); Bragi Schut (screenpl...</td>
      <td>[4]</td>
      <td>NaN</td>
      <td>2011</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>J A N U A R Y</td>
      <td>7.0</td>
      <td>The Time That Remains</td>
      <td>IFC Films</td>
      <td>Elia Suleiman (director); Elia Suleiman, Saleh...</td>
      <td>[5]</td>
      <td>NaN</td>
      <td>2011</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>J A N U A R Y</td>
      <td>14.0</td>
      <td>Barney's Version</td>
      <td>Sony Pictures Classics</td>
      <td>Richard J. Lewis (director); Michael Konyves (...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2011</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>93</th>
      <td>D E C E M B E R</td>
      <td>25.0</td>
      <td>The Tragedy of Macbeth</td>
      <td>Apple TV+ / A24 / IAC Films</td>
      <td>Joel Coen (director/screenplay); Denzel Washin...</td>
      <td>NaN</td>
      <td>[273]</td>
      <td>2021</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>94</th>
      <td>D E C E M B E R</td>
      <td>25.0</td>
      <td>A Journal for Jordan</td>
      <td>Columbia Pictures / Escape Artists / Bron Studios</td>
      <td>Denzel Washington (director); Virgil Williams ...</td>
      <td>NaN</td>
      <td>[274]</td>
      <td>2021</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>95</th>
      <td>D E C E M B E R</td>
      <td>25.0</td>
      <td>American Underdog</td>
      <td>Lionsgate</td>
      <td>Erwin brothers (directors); Jon Erwin, David A...</td>
      <td>NaN</td>
      <td>[275]</td>
      <td>2021</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>96</th>
      <td>D E C E M B E R</td>
      <td>26.0</td>
      <td>Memoria</td>
      <td>Neon</td>
      <td>Apichatpong Weerasethakul (director/acreenplay...</td>
      <td>NaN</td>
      <td>[276]</td>
      <td>2021</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>97</th>
      <td>D E C E M B E R</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2021</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>2813 rows × 9 columns</p>
</div></div></div>
</div>
</section>
<section id="pulling-from-the-omdb-api-a-class-anchor-id-omdbapi-a">
<h4>Pulling from the OMDB API  <a class="anchor" id="omdbAPI"></a><a class="headerlink" href="#pulling-from-the-omdb-api-a-class-anchor-id-omdbapi-a" title="Permalink to this heading">#</a></h4>
<p>Because we want information on Movies such as Director, Genre, Plot Summary, Rating, and Box Office Score along with IMDB Rating that the Wikipedia page does not contain, we need to find a way to find this information. Luckily, the <a class="reference external" href="https://www.imdb.com/">Internet Movie Database (IMDB)</a> has copious amounts of information regarding movies, and we can access this information by accessing the Online Movie Database(OMDB).</p>
<p>By requesting a key from <a class="reference external" href="https://www.omdbapi.com/">OMDB</a>, we can use this key to access details from the Application Programming Interface, or API, which will allow us to gather much more information regarding the movies.</p>
<p>We start by developing a function, search_movie, that takes in a movie title and generates a JSON (JavaScript Object Notation) object from the API. This JSON will gives us valuable information on any movie.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">search_movie</span><span class="p">(</span><span class="n">search_string</span><span class="p">):</span>
  <span class="c1"># We start a request session in order to create a GET Request from this API</span>
  <span class="n">sess</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
  <span class="c1"># Putting in the API Key, requested from OMDB</span>
  <span class="n">api_key</span> <span class="o">=</span> <span class="s1">&#39;9418ad5d&#39;</span>
  <span class="c1"># Building the url</span>
  <span class="n">base_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;http://www.omdbapi.com/?apikey=</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s1">&amp;&#39;</span>
  <span class="n">search_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&amp;t=</span><span class="si">{</span><span class="n">search_string</span><span class="si">}</span><span class="s1">&#39;</span>
  <span class="c1"># Now, pulling the movie information from the API using the request session</span>
  <span class="n">resp</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">base_url</span> <span class="o">+</span> <span class="n">search_url</span><span class="p">)</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
  <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</div>
</div>
<p>For example, lets search up one of the most popular movies, “The Avengers” and get its information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">search_movie</span><span class="p">(</span><span class="s1">&#39;The Avengers&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Title&#39;: &#39;The Avengers&#39;,
 &#39;Year&#39;: &#39;2012&#39;,
 &#39;Rated&#39;: &#39;PG-13&#39;,
 &#39;Released&#39;: &#39;04 May 2012&#39;,
 &#39;Runtime&#39;: &#39;143 min&#39;,
 &#39;Genre&#39;: &#39;Action, Sci-Fi&#39;,
 &#39;Director&#39;: &#39;Joss Whedon&#39;,
 &#39;Writer&#39;: &#39;Joss Whedon, Zak Penn&#39;,
 &#39;Actors&#39;: &#39;Robert Downey Jr., Chris Evans, Scarlett Johansson&#39;,
 &#39;Plot&#39;: &quot;Earth&#39;s mightiest heroes must come together and learn to fight as a team if they are going to stop the mischievous Loki and his alien army from enslaving humanity.&quot;,
 &#39;Language&#39;: &#39;English, Russian&#39;,
 &#39;Country&#39;: &#39;United States&#39;,
 &#39;Awards&#39;: &#39;Nominated for 1 Oscar. 38 wins &amp; 80 nominations total&#39;,
 &#39;Poster&#39;: &#39;https://m.media-amazon.com/images/M/MV5BNDYxNjQyMjAtNTdiOS00NGYwLWFmNTAtNThmYjU5ZGI2YTI1XkEyXkFqcGdeQXVyMTMxODk2OTU@._V1_SX300.jpg&#39;,
 &#39;Ratings&#39;: [{&#39;Source&#39;: &#39;Internet Movie Database&#39;, &#39;Value&#39;: &#39;8.0/10&#39;},
  {&#39;Source&#39;: &#39;Rotten Tomatoes&#39;, &#39;Value&#39;: &#39;91%&#39;},
  {&#39;Source&#39;: &#39;Metacritic&#39;, &#39;Value&#39;: &#39;69/100&#39;}],
 &#39;Metascore&#39;: &#39;69&#39;,
 &#39;imdbRating&#39;: &#39;8.0&#39;,
 &#39;imdbVotes&#39;: &#39;1,411,647&#39;,
 &#39;imdbID&#39;: &#39;tt0848228&#39;,
 &#39;Type&#39;: &#39;movie&#39;,
 &#39;DVD&#39;: &#39;25 Sep 2012&#39;,
 &#39;BoxOffice&#39;: &#39;$623,357,910&#39;,
 &#39;Production&#39;: &#39;N/A&#39;,
 &#39;Website&#39;: &#39;N/A&#39;,
 &#39;Response&#39;: &#39;True&#39;}
</pre></div>
</div>
</div>
</div>
</section>
<section id="creating-our-appended-dataframe">
<h4>Creating our Appended DataFrame<a class="headerlink" href="#creating-our-appended-dataframe" title="Permalink to this heading">#</a></h4>
<p>Now, we want to create a new DataFrame with this added information. We define a function, append_frame, which takes in a dictionary of sought after columns and fills this dictionary with information from the API, creating a DataFrame out of this information.</p>
<p>The Categories that we want to analyze are as follows:</p>
<ol class="arabic simple">
<li><p>Genre</p></li>
<li><p>Actors</p></li>
<li><p>Director</p></li>
<li><p>Plot</p></li>
<li><p>Country</p></li>
<li><p>Language</p></li>
<li><p>IMDBRating</p></li>
<li><p>BoxOffice</p></li>
<li><p>IMDBVotes</p></li>
<li><p>Metascore</p></li>
<li><p>Rated (PG, R, PG-13, etc.)</p></li>
</ol>
<p>We then make calls to the API for these particular categories, and for each Title in the current database, we add this new information about the title to a column if it exists in the API.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We start with our list of desired columns columns</span>
<span class="n">lst</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Genre&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;Actors&quot;</span><span class="p">:[],</span> <span class="s2">&quot;Director&quot;</span><span class="p">:[],</span> <span class="s2">&quot;Plot&quot;</span><span class="p">:[],</span> <span class="s2">&quot;Country&quot;</span><span class="p">:[],</span> <span class="s2">&quot;Language&quot;</span><span class="p">:[],</span> <span class="s2">&quot;imdbRating&quot;</span><span class="p">:[],</span> <span class="s2">&quot;BoxOffice&quot;</span><span class="p">:[],</span>\
       <span class="s2">&quot;imdbVotes&quot;</span><span class="p">:[],</span> <span class="s2">&quot;Metascore&quot;</span><span class="p">:[],</span> <span class="s2">&quot;Rated&quot;</span><span class="p">:</span> <span class="p">[]}</span>
<span class="k">def</span> <span class="nf">append_frame</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
    <span class="c1"># Now for each title in the DataFrame, we want to make an API Request for every category listed.</span>
    <span class="k">for</span> <span class="n">title</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">]:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">search_movie</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="c1"># Now, d is our JSON Object. We want to check if there was a response in the API for this movie.</span>
        <span class="c1"># If there was, we can on to append the features. </span>
        <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;Response&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;True&#39;</span><span class="p">:</span>
            <span class="c1"># Now for every feature, append the output from the JSON object if it exists. Otherwise, append NaN.</span>
            <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">lst</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> 
                    <span class="n">lst</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">feature</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lst</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># In this case, the title was not found in the dataframe, in which case we can simply set features to NaN</span>
            <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">lst</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">lst</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
                
    <span class="c1"># make the dictionary into a DataFrame, and return it</span>
    <span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dataframe</span>

<span class="c1"># Now, we call this method on our data</span>
<span class="n">api_response</span> <span class="o">=</span> <span class="n">append_frame</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">api_response</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Genre</th>
      <th>Actors</th>
      <th>Director</th>
      <th>Plot</th>
      <th>Country</th>
      <th>Language</th>
      <th>imdbRating</th>
      <th>BoxOffice</th>
      <th>imdbVotes</th>
      <th>Metascore</th>
      <th>Rated</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Drama</td>
      <td>George Pistereanu, Ada Condeescu, Mihai Consta...</td>
      <td>Florin Serban</td>
      <td>Two weeks before his release, a teenage prison...</td>
      <td>Romania, Sweden, Germany</td>
      <td>Romanian</td>
      <td>7.0</td>
      <td>$12,135</td>
      <td>6,424</td>
      <td>64</td>
      <td>Unrated</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Documentary, Biography, History</td>
      <td>Salvador Allende, Erik Andersen, Joan Baez</td>
      <td>Kenneth Bowser</td>
      <td>From civil rights to the anti-war movement to ...</td>
      <td>United States</td>
      <td>English</td>
      <td>7.8</td>
      <td>$263,723</td>
      <td>405</td>
      <td>72</td>
      <td>Unrated</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Action, Adventure, Fantasy</td>
      <td>Nicolas Cage, Ron Perlman, Claire Foy</td>
      <td>Dominic Sena</td>
      <td>14th-century knights transport a suspected wit...</td>
      <td>United States</td>
      <td>English, Latin</td>
      <td>5.4</td>
      <td>$24,827,228</td>
      <td>95,932</td>
      <td>28</td>
      <td>PG-13</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Drama, History</td>
      <td>Menashe Noy, Elia Suleiman, Baher Agbariya</td>
      <td>Elia Suleiman</td>
      <td>An examination of the creation of the state of...</td>
      <td>France, Belgium, Italy, United Kingdom, United...</td>
      <td>Arabic, Hebrew, English</td>
      <td>7.0</td>
      <td>$32,869</td>
      <td>2,590</td>
      <td>74</td>
      <td>Not Rated</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Comedy, Drama</td>
      <td>Paul Giamatti, Rosamund Pike, Jake Hoffman</td>
      <td>Richard J. Lewis</td>
      <td>The picaresque and touching story of the polit...</td>
      <td>Italy, Canada</td>
      <td>English, French</td>
      <td>7.3</td>
      <td>$4,439,201</td>
      <td>25,586</td>
      <td>67</td>
      <td>R</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2808</th>
      <td>Drama, Mystery, Thriller</td>
      <td>Denzel Washington, Frances McDormand, Alex Has...</td>
      <td>Joel Coen</td>
      <td>A Scottish lord becomes convinced by a trio of...</td>
      <td>United States</td>
      <td>English, Persian</td>
      <td>7.1</td>
      <td>N/A</td>
      <td>36,172</td>
      <td>87</td>
      <td>R</td>
    </tr>
    <tr>
      <th>2809</th>
      <td>Drama</td>
      <td>Michael B. Jordan, Chanté Adams, Jalon Christian</td>
      <td>Denzel Washington</td>
      <td>1st Sgt. Charles Monroe King, before he is kil...</td>
      <td>United States</td>
      <td>English</td>
      <td>5.9</td>
      <td>$6,545,174</td>
      <td>2,367</td>
      <td>42</td>
      <td>PG-13</td>
    </tr>
    <tr>
      <th>2810</th>
      <td>Biography, Drama, Sport</td>
      <td>Zachary Levi, Anna Paquin, Hayden Zaller</td>
      <td>Andrew Erwin, Jon Erwin</td>
      <td>The story of NFL MVP and Hall of Fame quarterb...</td>
      <td>United States</td>
      <td>English</td>
      <td>7.1</td>
      <td>$26,514,814</td>
      <td>17,228</td>
      <td>53</td>
      <td>PG</td>
    </tr>
    <tr>
      <th>2811</th>
      <td>Drama, Mystery, Sci-Fi</td>
      <td>Tilda Swinton, Agnes Brekke, Daniel Giménez Cacho</td>
      <td>Apichatpong Weerasethakul</td>
      <td>A woman from Scotland, while traveling in Colo...</td>
      <td>Colombia, Thailand, France, Germany, Mexico, Q...</td>
      <td>English, Spanish</td>
      <td>6.5</td>
      <td>$52,656</td>
      <td>9,572</td>
      <td>91</td>
      <td>PG</td>
    </tr>
    <tr>
      <th>2812</th>
      <td>Comedy</td>
      <td>Paul Reid, Emer Hedderman, Rosalie Craig</td>
      <td>Josie Rourke</td>
      <td>Catherine Tate's iconic character Nan hits the...</td>
      <td>United Kingdom</td>
      <td>English</td>
      <td>4.7</td>
      <td>N/A</td>
      <td>1,321</td>
      <td>N/A</td>
      <td>N/A</td>
    </tr>
  </tbody>
</table>
<p>2813 rows × 11 columns</p>
</div></div></div>
</div>
<p>Now, we can combine the two previous dataframes by creating a title column for this DataFrame, which will match exactly with the title column for the previously scraped data from Wikipedia.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">api_response</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1"># setting the titles to match that of Wikipedia.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Genre</th>
      <th>Actors</th>
      <th>Director</th>
      <th>Plot</th>
      <th>Country</th>
      <th>Language</th>
      <th>imdbRating</th>
      <th>BoxOffice</th>
      <th>imdbVotes</th>
      <th>Metascore</th>
      <th>Rated</th>
      <th>Title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Drama</td>
      <td>George Pistereanu, Ada Condeescu, Mihai Consta...</td>
      <td>Florin Serban</td>
      <td>Two weeks before his release, a teenage prison...</td>
      <td>Romania, Sweden, Germany</td>
      <td>Romanian</td>
      <td>7.0</td>
      <td>$12,135</td>
      <td>6,424</td>
      <td>64</td>
      <td>Unrated</td>
      <td>If I Want to Whistle, I Whistle</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Documentary, Biography, History</td>
      <td>Salvador Allende, Erik Andersen, Joan Baez</td>
      <td>Kenneth Bowser</td>
      <td>From civil rights to the anti-war movement to ...</td>
      <td>United States</td>
      <td>English</td>
      <td>7.8</td>
      <td>$263,723</td>
      <td>405</td>
      <td>72</td>
      <td>Unrated</td>
      <td>Phil Ochs: There but for Fortune</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Action, Adventure, Fantasy</td>
      <td>Nicolas Cage, Ron Perlman, Claire Foy</td>
      <td>Dominic Sena</td>
      <td>14th-century knights transport a suspected wit...</td>
      <td>United States</td>
      <td>English, Latin</td>
      <td>5.4</td>
      <td>$24,827,228</td>
      <td>95,932</td>
      <td>28</td>
      <td>PG-13</td>
      <td>Season of the Witch</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Drama, History</td>
      <td>Menashe Noy, Elia Suleiman, Baher Agbariya</td>
      <td>Elia Suleiman</td>
      <td>An examination of the creation of the state of...</td>
      <td>France, Belgium, Italy, United Kingdom, United...</td>
      <td>Arabic, Hebrew, English</td>
      <td>7.0</td>
      <td>$32,869</td>
      <td>2,590</td>
      <td>74</td>
      <td>Not Rated</td>
      <td>The Time That Remains</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Comedy, Drama</td>
      <td>Paul Giamatti, Rosamund Pike, Jake Hoffman</td>
      <td>Richard J. Lewis</td>
      <td>The picaresque and touching story of the polit...</td>
      <td>Italy, Canada</td>
      <td>English, French</td>
      <td>7.3</td>
      <td>$4,439,201</td>
      <td>25,586</td>
      <td>67</td>
      <td>R</td>
      <td>Barney's Version</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2808</th>
      <td>Drama, Mystery, Thriller</td>
      <td>Denzel Washington, Frances McDormand, Alex Has...</td>
      <td>Joel Coen</td>
      <td>A Scottish lord becomes convinced by a trio of...</td>
      <td>United States</td>
      <td>English, Persian</td>
      <td>7.1</td>
      <td>N/A</td>
      <td>36,172</td>
      <td>87</td>
      <td>R</td>
      <td>The Tragedy of Macbeth</td>
    </tr>
    <tr>
      <th>2809</th>
      <td>Drama</td>
      <td>Michael B. Jordan, Chanté Adams, Jalon Christian</td>
      <td>Denzel Washington</td>
      <td>1st Sgt. Charles Monroe King, before he is kil...</td>
      <td>United States</td>
      <td>English</td>
      <td>5.9</td>
      <td>$6,545,174</td>
      <td>2,367</td>
      <td>42</td>
      <td>PG-13</td>
      <td>A Journal for Jordan</td>
    </tr>
    <tr>
      <th>2810</th>
      <td>Biography, Drama, Sport</td>
      <td>Zachary Levi, Anna Paquin, Hayden Zaller</td>
      <td>Andrew Erwin, Jon Erwin</td>
      <td>The story of NFL MVP and Hall of Fame quarterb...</td>
      <td>United States</td>
      <td>English</td>
      <td>7.1</td>
      <td>$26,514,814</td>
      <td>17,228</td>
      <td>53</td>
      <td>PG</td>
      <td>American Underdog</td>
    </tr>
    <tr>
      <th>2811</th>
      <td>Drama, Mystery, Sci-Fi</td>
      <td>Tilda Swinton, Agnes Brekke, Daniel Giménez Cacho</td>
      <td>Apichatpong Weerasethakul</td>
      <td>A woman from Scotland, while traveling in Colo...</td>
      <td>Colombia, Thailand, France, Germany, Mexico, Q...</td>
      <td>English, Spanish</td>
      <td>6.5</td>
      <td>$52,656</td>
      <td>9,572</td>
      <td>91</td>
      <td>PG</td>
      <td>Memoria</td>
    </tr>
    <tr>
      <th>2812</th>
      <td>Comedy</td>
      <td>Paul Reid, Emer Hedderman, Rosalie Craig</td>
      <td>Josie Rourke</td>
      <td>Catherine Tate's iconic character Nan hits the...</td>
      <td>United Kingdom</td>
      <td>English</td>
      <td>4.7</td>
      <td>N/A</td>
      <td>1,321</td>
      <td>N/A</td>
      <td>N/A</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>2813 rows × 12 columns</p>
</div></div></div>
</div>
</section>
</section>
<section id="data-cleaning-organizing-relavent-information-addressing-missing-data-a-class-anchor-id-cleanprocess-a">
<h3>Data Cleaning: Organizing Relavent Information &amp; Addressing Missing Data  <a class="anchor" id="cleanProcess"></a><a class="headerlink" href="#data-cleaning-organizing-relavent-information-addressing-missing-data-a-class-anchor-id-cleanprocess-a" title="Permalink to this heading">#</a></h3>
<section id="organizing-relavent-information">
<h4>Organizing Relavent Information<a class="headerlink" href="#organizing-relavent-information" title="Permalink to this heading">#</a></h4>
<p>Since some information from the original Wikipedia scraped database is valuable, we want to maintain the storage of that information in the new DataFrame, but since some of it is messy, it needs to be organized a bit. First, we keep the Production Company data, which can remain untouched. Then, we want to add the date. In general, for our analysis, we need to maintain the year seperate, so we will avoid creating a datetime object. Instead, we will clean up the months formatting, along with renaming some of the columns to be more relavent to their purpose.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Production Company&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Production company&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span>
<span class="c1"># We want to remove whitespace from the Month,as well as making it lowercase.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Opening&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Opening.1&#39;</span><span class="p">]</span>
<span class="c1"># Reorganizing the dataframe so that Title is now the first column</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Title&#39;</span><span class="p">,</span><span class="s1">&#39;Genre&#39;</span><span class="p">,</span> <span class="s1">&#39;Actors&#39;</span><span class="p">,</span> <span class="s1">&#39;Director&#39;</span><span class="p">,</span> <span class="s1">&#39;Plot&#39;</span><span class="p">,</span> <span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Language&#39;</span><span class="p">,</span>
       <span class="s1">&#39;imdbRating&#39;</span><span class="p">,</span> <span class="s1">&#39;BoxOffice&#39;</span><span class="p">,</span> <span class="s1">&#39;imdbVotes&#39;</span><span class="p">,</span> <span class="s1">&#39;Metascore&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;Production Company&#39;</span><span class="p">,</span><span class="s1">&#39;Rated&#39;</span><span class="p">]]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Title</th>
      <th>Genre</th>
      <th>Actors</th>
      <th>Director</th>
      <th>Plot</th>
      <th>Country</th>
      <th>Language</th>
      <th>imdbRating</th>
      <th>BoxOffice</th>
      <th>imdbVotes</th>
      <th>Metascore</th>
      <th>month</th>
      <th>day</th>
      <th>year</th>
      <th>Production Company</th>
      <th>Rated</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>If I Want to Whistle, I Whistle</td>
      <td>Drama</td>
      <td>George Pistereanu, Ada Condeescu, Mihai Consta...</td>
      <td>Florin Serban</td>
      <td>Two weeks before his release, a teenage prison...</td>
      <td>Romania, Sweden, Germany</td>
      <td>Romanian</td>
      <td>7.0</td>
      <td>$12,135</td>
      <td>6,424</td>
      <td>64</td>
      <td>january</td>
      <td>5.0</td>
      <td>2011</td>
      <td>Film Movement</td>
      <td>Unrated</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Phil Ochs: There but for Fortune</td>
      <td>Documentary, Biography, History</td>
      <td>Salvador Allende, Erik Andersen, Joan Baez</td>
      <td>Kenneth Bowser</td>
      <td>From civil rights to the anti-war movement to ...</td>
      <td>United States</td>
      <td>English</td>
      <td>7.8</td>
      <td>$263,723</td>
      <td>405</td>
      <td>72</td>
      <td>january</td>
      <td>5.0</td>
      <td>2011</td>
      <td>First Run Features</td>
      <td>Unrated</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Season of the Witch</td>
      <td>Action, Adventure, Fantasy</td>
      <td>Nicolas Cage, Ron Perlman, Claire Foy</td>
      <td>Dominic Sena</td>
      <td>14th-century knights transport a suspected wit...</td>
      <td>United States</td>
      <td>English, Latin</td>
      <td>5.4</td>
      <td>$24,827,228</td>
      <td>95,932</td>
      <td>28</td>
      <td>january</td>
      <td>7.0</td>
      <td>2011</td>
      <td>Rogue Pictures / Relativity Media</td>
      <td>PG-13</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The Time That Remains</td>
      <td>Drama, History</td>
      <td>Menashe Noy, Elia Suleiman, Baher Agbariya</td>
      <td>Elia Suleiman</td>
      <td>An examination of the creation of the state of...</td>
      <td>France, Belgium, Italy, United Kingdom, United...</td>
      <td>Arabic, Hebrew, English</td>
      <td>7.0</td>
      <td>$32,869</td>
      <td>2,590</td>
      <td>74</td>
      <td>january</td>
      <td>7.0</td>
      <td>2011</td>
      <td>IFC Films</td>
      <td>Not Rated</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Barney's Version</td>
      <td>Comedy, Drama</td>
      <td>Paul Giamatti, Rosamund Pike, Jake Hoffman</td>
      <td>Richard J. Lewis</td>
      <td>The picaresque and touching story of the polit...</td>
      <td>Italy, Canada</td>
      <td>English, French</td>
      <td>7.3</td>
      <td>$4,439,201</td>
      <td>25,586</td>
      <td>67</td>
      <td>january</td>
      <td>14.0</td>
      <td>2011</td>
      <td>Sony Pictures Classics</td>
      <td>R</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2808</th>
      <td>The Tragedy of Macbeth</td>
      <td>Drama, Mystery, Thriller</td>
      <td>Denzel Washington, Frances McDormand, Alex Has...</td>
      <td>Joel Coen</td>
      <td>A Scottish lord becomes convinced by a trio of...</td>
      <td>United States</td>
      <td>English, Persian</td>
      <td>7.1</td>
      <td>N/A</td>
      <td>36,172</td>
      <td>87</td>
      <td>december</td>
      <td>25.0</td>
      <td>2021</td>
      <td>Apple TV+ / A24 / IAC Films</td>
      <td>R</td>
    </tr>
    <tr>
      <th>2809</th>
      <td>A Journal for Jordan</td>
      <td>Drama</td>
      <td>Michael B. Jordan, Chanté Adams, Jalon Christian</td>
      <td>Denzel Washington</td>
      <td>1st Sgt. Charles Monroe King, before he is kil...</td>
      <td>United States</td>
      <td>English</td>
      <td>5.9</td>
      <td>$6,545,174</td>
      <td>2,367</td>
      <td>42</td>
      <td>december</td>
      <td>25.0</td>
      <td>2021</td>
      <td>Columbia Pictures / Escape Artists / Bron Studios</td>
      <td>PG-13</td>
    </tr>
    <tr>
      <th>2810</th>
      <td>American Underdog</td>
      <td>Biography, Drama, Sport</td>
      <td>Zachary Levi, Anna Paquin, Hayden Zaller</td>
      <td>Andrew Erwin, Jon Erwin</td>
      <td>The story of NFL MVP and Hall of Fame quarterb...</td>
      <td>United States</td>
      <td>English</td>
      <td>7.1</td>
      <td>$26,514,814</td>
      <td>17,228</td>
      <td>53</td>
      <td>december</td>
      <td>25.0</td>
      <td>2021</td>
      <td>Lionsgate</td>
      <td>PG</td>
    </tr>
    <tr>
      <th>2811</th>
      <td>Memoria</td>
      <td>Drama, Mystery, Sci-Fi</td>
      <td>Tilda Swinton, Agnes Brekke, Daniel Giménez Cacho</td>
      <td>Apichatpong Weerasethakul</td>
      <td>A woman from Scotland, while traveling in Colo...</td>
      <td>Colombia, Thailand, France, Germany, Mexico, Q...</td>
      <td>English, Spanish</td>
      <td>6.5</td>
      <td>$52,656</td>
      <td>9,572</td>
      <td>91</td>
      <td>december</td>
      <td>26.0</td>
      <td>2021</td>
      <td>Neon</td>
      <td>PG</td>
    </tr>
    <tr>
      <th>2812</th>
      <td>NaN</td>
      <td>Comedy</td>
      <td>Paul Reid, Emer Hedderman, Rosalie Craig</td>
      <td>Josie Rourke</td>
      <td>Catherine Tate's iconic character Nan hits the...</td>
      <td>United Kingdom</td>
      <td>English</td>
      <td>4.7</td>
      <td>N/A</td>
      <td>1,321</td>
      <td>N/A</td>
      <td>december</td>
      <td>NaN</td>
      <td>2021</td>
      <td>NaN</td>
      <td>N/A</td>
    </tr>
  </tbody>
</table>
<p>2813 rows × 16 columns</p>
</div></div></div>
</div>
</section>
<section id="missing-data">
<h4>Missing Data<a class="headerlink" href="#missing-data" title="Permalink to this heading">#</a></h4>
<p>Now, we want to address missing data. We will do this as follows:</p>
<ol class="arabic simple">
<li><p>Any row that has a title missing will be dropped. These rows are pointless to anaylze, since there is no use when we do not know which movie is being discussed</p></li>
<li><p>Any row with both imdbRating and BoxOffice missing are also dropped. Since these are two key points of analysis, we need not account for any row in our dataframe that has both of these missing.</p></li>
</ol>
<p>This will allow our dataset to be prepped for analysis, given that missing data can affect certain methods of analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total</span> <span class="o">=</span> <span class="n">df</span>
<span class="n">total</span><span class="p">[</span><span class="s2">&quot;Title&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="c1"># Finding all of those with Titles missing, or both imdbRating and BoxOffice</span>
<span class="n">total</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;imdbRating&#39;</span><span class="p">,</span> <span class="s1">&#39;BoxOffice&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">numeric_only</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">total</span> <span class="o">=</span> <span class="n">total</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">])</span>
<span class="n">total</span> <span class="o">=</span> <span class="n">total</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;imdbRating&#39;</span><span class="p">,</span> <span class="s1">&#39;BoxOffice&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">total</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Title</th>
      <th>Genre</th>
      <th>Actors</th>
      <th>Director</th>
      <th>Plot</th>
      <th>Country</th>
      <th>Language</th>
      <th>imdbRating</th>
      <th>BoxOffice</th>
      <th>imdbVotes</th>
      <th>Metascore</th>
      <th>month</th>
      <th>day</th>
      <th>year</th>
      <th>Production Company</th>
      <th>Rated</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>If I Want to Whistle, I Whistle</td>
      <td>Drama</td>
      <td>George Pistereanu, Ada Condeescu, Mihai Consta...</td>
      <td>Florin Serban</td>
      <td>Two weeks before his release, a teenage prison...</td>
      <td>Romania, Sweden, Germany</td>
      <td>Romanian</td>
      <td>7.0</td>
      <td>$12,135</td>
      <td>6,424</td>
      <td>64</td>
      <td>january</td>
      <td>5.0</td>
      <td>2011</td>
      <td>Film Movement</td>
      <td>Unrated</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Phil Ochs: There but for Fortune</td>
      <td>Documentary, Biography, History</td>
      <td>Salvador Allende, Erik Andersen, Joan Baez</td>
      <td>Kenneth Bowser</td>
      <td>From civil rights to the anti-war movement to ...</td>
      <td>United States</td>
      <td>English</td>
      <td>7.8</td>
      <td>$263,723</td>
      <td>405</td>
      <td>72</td>
      <td>january</td>
      <td>5.0</td>
      <td>2011</td>
      <td>First Run Features</td>
      <td>Unrated</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Season of the Witch</td>
      <td>Action, Adventure, Fantasy</td>
      <td>Nicolas Cage, Ron Perlman, Claire Foy</td>
      <td>Dominic Sena</td>
      <td>14th-century knights transport a suspected wit...</td>
      <td>United States</td>
      <td>English, Latin</td>
      <td>5.4</td>
      <td>$24,827,228</td>
      <td>95,932</td>
      <td>28</td>
      <td>january</td>
      <td>7.0</td>
      <td>2011</td>
      <td>Rogue Pictures / Relativity Media</td>
      <td>PG-13</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The Time That Remains</td>
      <td>Drama, History</td>
      <td>Menashe Noy, Elia Suleiman, Baher Agbariya</td>
      <td>Elia Suleiman</td>
      <td>An examination of the creation of the state of...</td>
      <td>France, Belgium, Italy, United Kingdom, United...</td>
      <td>Arabic, Hebrew, English</td>
      <td>7.0</td>
      <td>$32,869</td>
      <td>2,590</td>
      <td>74</td>
      <td>january</td>
      <td>7.0</td>
      <td>2011</td>
      <td>IFC Films</td>
      <td>Not Rated</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Barney's Version</td>
      <td>Comedy, Drama</td>
      <td>Paul Giamatti, Rosamund Pike, Jake Hoffman</td>
      <td>Richard J. Lewis</td>
      <td>The picaresque and touching story of the polit...</td>
      <td>Italy, Canada</td>
      <td>English, French</td>
      <td>7.3</td>
      <td>$4,439,201</td>
      <td>25,586</td>
      <td>67</td>
      <td>january</td>
      <td>14.0</td>
      <td>2011</td>
      <td>Sony Pictures Classics</td>
      <td>R</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2807</th>
      <td>The King's Man</td>
      <td>Action, Adventure, Thriller</td>
      <td>Ralph Fiennes, Gemma Arterton, Rhys Ifans</td>
      <td>Matthew Vaughn</td>
      <td>In the early years of the 20th century, the Ki...</td>
      <td>United Kingdom, United States</td>
      <td>English, Latin, German, French, Russian</td>
      <td>6.3</td>
      <td>$37,176,373</td>
      <td>156,453</td>
      <td>44</td>
      <td>december</td>
      <td>22.0</td>
      <td>2021</td>
      <td>20th Century Studios / Marv Studios / TSG Ente...</td>
      <td>R</td>
    </tr>
    <tr>
      <th>2808</th>
      <td>The Tragedy of Macbeth</td>
      <td>Drama, Mystery, Thriller</td>
      <td>Denzel Washington, Frances McDormand, Alex Has...</td>
      <td>Joel Coen</td>
      <td>A Scottish lord becomes convinced by a trio of...</td>
      <td>United States</td>
      <td>English, Persian</td>
      <td>7.1</td>
      <td>N/A</td>
      <td>36,172</td>
      <td>87</td>
      <td>december</td>
      <td>25.0</td>
      <td>2021</td>
      <td>Apple TV+ / A24 / IAC Films</td>
      <td>R</td>
    </tr>
    <tr>
      <th>2809</th>
      <td>A Journal for Jordan</td>
      <td>Drama</td>
      <td>Michael B. Jordan, Chanté Adams, Jalon Christian</td>
      <td>Denzel Washington</td>
      <td>1st Sgt. Charles Monroe King, before he is kil...</td>
      <td>United States</td>
      <td>English</td>
      <td>5.9</td>
      <td>$6,545,174</td>
      <td>2,367</td>
      <td>42</td>
      <td>december</td>
      <td>25.0</td>
      <td>2021</td>
      <td>Columbia Pictures / Escape Artists / Bron Studios</td>
      <td>PG-13</td>
    </tr>
    <tr>
      <th>2810</th>
      <td>American Underdog</td>
      <td>Biography, Drama, Sport</td>
      <td>Zachary Levi, Anna Paquin, Hayden Zaller</td>
      <td>Andrew Erwin, Jon Erwin</td>
      <td>The story of NFL MVP and Hall of Fame quarterb...</td>
      <td>United States</td>
      <td>English</td>
      <td>7.1</td>
      <td>$26,514,814</td>
      <td>17,228</td>
      <td>53</td>
      <td>december</td>
      <td>25.0</td>
      <td>2021</td>
      <td>Lionsgate</td>
      <td>PG</td>
    </tr>
    <tr>
      <th>2811</th>
      <td>Memoria</td>
      <td>Drama, Mystery, Sci-Fi</td>
      <td>Tilda Swinton, Agnes Brekke, Daniel Giménez Cacho</td>
      <td>Apichatpong Weerasethakul</td>
      <td>A woman from Scotland, while traveling in Colo...</td>
      <td>Colombia, Thailand, France, Germany, Mexico, Q...</td>
      <td>English, Spanish</td>
      <td>6.5</td>
      <td>$52,656</td>
      <td>9,572</td>
      <td>91</td>
      <td>december</td>
      <td>26.0</td>
      <td>2021</td>
      <td>Neon</td>
      <td>PG</td>
    </tr>
  </tbody>
</table>
<p>2759 rows × 16 columns</p>
</div></div></div>
</div>
</section>
<section id="using-the-tmdb-api-a-class-anchor-id-tmdbapi-a">
<h4>Using the TMDB API  <a class="anchor" id="tmdbAPI"></a><a class="headerlink" href="#using-the-tmdb-api-a-class-anchor-id-tmdbapi-a" title="Permalink to this heading">#</a></h4>
<p>Despite the copious amount of information that we gained from the OMDB API, we are missing two key pieces of information in analyzing movies: Budget and Keywords. With Budget, we can understand how much investment went into a movie. This is vital in seeing if a particular movie lived up to its expectation. Keywords or Tags help us generate some sort of inside into the details in the movie. While genre tells us what sort of movie it is, keywords provide specific information into the subgenre. For example, the Avengers, while classified as action, is specfically a Superhero movie in the Marvel Universe, and such words would be tagged as keywords. This will help us in deciding which movie to recommend to a person.</p>
<p>We can get this information from another databases’ API, The Movie DataBase (TMDB). This API has plenty more information on movies, but we will focus on Budget and Keywords as mentioned before. To this point, we will develop functions get_budget and get_keywords that take in a movie’s title and generate the Budget and Keywords from the API. Similar to the other API, we start a equest session, form the URL, and use an API Key given by TMDB in order to retrieve the information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_budget</span><span class="p">(</span><span class="n">title</span><span class="p">):</span>
    <span class="c1"># starting the session in order to get info from the API</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">)</span>
    <span class="n">sess</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
    <span class="c1"># We then form our url with our title, api key and base url</span>
    <span class="n">api_key</span> <span class="o">=</span> <span class="s1">&#39;58ea292f930b11d66214fcb7a1bae448&#39;</span>
    <span class="n">base_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://api.themoviedb.org/3/search/movie?api_key=</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s1">&amp;query=</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">base_url</span><span class="p">)</span>
    <span class="c1"># retrieving data as a json, but since this json does not contain the neccesary information, we </span>
    <span class="c1"># take the id from the json and use it in a different request(if results came, otherwise we simply </span>
    <span class="c1"># append np.nan</span>
    <span class="n">datas</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datas</span><span class="p">[</span><span class="s1">&#39;results&#39;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="c1"># use the id as mentioned to get the budget from the JSON in a similar request.</span>
    <span class="n">eyedee</span> <span class="o">=</span> <span class="n">datas</span><span class="p">[</span><span class="s1">&#39;results&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://api.themoviedb.org/3/movie/</span><span class="si">{</span><span class="n">eyedee</span><span class="si">}</span><span class="s1">?api_key=58ea292f930b11d66214fcb7a1bae448&#39;</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">data2</span> <span class="o">=</span> <span class="n">r2</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">data2</span><span class="p">[</span><span class="s1">&#39;budget&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>To test, we’ll find out what the budget was for “The Avengers”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_budget</span><span class="p">(</span><span class="s2">&quot;The Avengers&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>220000000
</pre></div>
</div>
</div>
</div>
<p>Now, we wish to generate the keywords instead of the budget and test it on “The Avengers”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Almost identical to Budget, but instead we wish to generate the keywords instead of the Budget. </span>
<span class="k">def</span> <span class="nf">get_keywords</span><span class="p">(</span><span class="n">title</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">)</span>
    <span class="c1"># starting the session in order to get info from the API</span>
    <span class="n">sess</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
    <span class="c1"># We then form our url with our title, api key and base url</span>

    <span class="n">api_key</span> <span class="o">=</span> <span class="s1">&#39;58ea292f930b11d66214fcb7a1bae448&#39;</span>
    <span class="n">base_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://api.themoviedb.org/3/search/movie?api_key=</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s1">&amp;query=</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">base_url</span><span class="p">)</span>
    
    <span class="c1"># retrieving data as a json, but since this json does not contain the neccesary information, we </span>
    <span class="c1"># take the id from the json and use it in a different request(if results came, otherwise we simply </span>
    <span class="c1"># append np.nan</span>
    <span class="n">datas</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datas</span><span class="p">[</span><span class="s1">&#39;results&#39;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    
    <span class="c1"># use the id as mentioned to get the budget from the JSON in a similar request.</span>
    <span class="n">eyedee</span> <span class="o">=</span> <span class="n">datas</span><span class="p">[</span><span class="s1">&#39;results&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://api.themoviedb.org/3/movie/</span><span class="si">{</span><span class="n">eyedee</span><span class="si">}</span><span class="s1">/keywords?api_key=58ea292f930b11d66214fcb7a1bae448&#39;</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">data2</span> <span class="o">=</span> <span class="n">r2</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">data2</span><span class="p">[</span><span class="s1">&#39;keywords&#39;</span><span class="p">]</span>

<span class="n">get_keywords</span><span class="p">(</span><span class="s2">&quot;The Avengers&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;id&#39;: 242, &#39;name&#39;: &#39;new york city&#39;},
 {&#39;id&#39;: 5539, &#39;name&#39;: &#39;shield&#39;},
 {&#39;id&#39;: 9715, &#39;name&#39;: &#39;superhero&#39;},
 {&#39;id&#39;: 9717, &#39;name&#39;: &#39;based on comic&#39;},
 {&#39;id&#39;: 14909, &#39;name&#39;: &#39;alien invasion&#39;},
 {&#39;id&#39;: 155030, &#39;name&#39;: &#39;superhero team&#39;},
 {&#39;id&#39;: 179430, &#39;name&#39;: &#39;aftercreditsstinger&#39;},
 {&#39;id&#39;: 179431, &#39;name&#39;: &#39;duringcreditsstinger&#39;},
 {&#39;id&#39;: 180547, &#39;name&#39;: &#39;marvel cinematic universe (mcu)&#39;}]
</pre></div>
</div>
</div>
</div>
<p>We now apply this to dataframe’s title column, generating the budgets and keywords into a Series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">info</span> <span class="o">=</span> <span class="n">total</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">get_budget</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">get_keywords</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="n">info</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0                                                 (0, [])
1                                                 (0, [])
2       (40000000, [{&#39;id&#39;: 344, &#39;name&#39;: &#39;inquisition&#39;}...
3           (6500000, [{&#39;id&#39;: 537, &#39;name&#39;: &#39;palestine&#39;}])
4       (30000000, [{&#39;id&#39;: 236, &#39;name&#39;: &#39;suicide&#39;}, {&#39;...
                              ...                        
2807    (100000000, [{&#39;id&#39;: 212, &#39;name&#39;: &#39;london, engl...
2808    (0, [{&#39;id&#39;: 388, &#39;name&#39;: &#39;scotland&#39;}, {&#39;id&#39;: 1...
2809                                              (0, [])
2810    (0, [{&#39;id&#39;: 579, &#39;name&#39;: &#39;american football&#39;},...
2811    (0, [{&#39;id&#39;: 155800, &#39;name&#39;: &#39;atmospheric&#39;}, {&#39;...
Name: Title, Length: 2759, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Then, we can unpack this series into a dataframe, and then index the dataframe to create our new columns!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tmdb_response</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span>
<span class="n">total</span><span class="p">[</span><span class="s1">&#39;Budget&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmdb_response</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">total</span><span class="p">[</span><span class="s1">&#39;Keywords&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmdb_response</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">total</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Title</th>
      <th>Genre</th>
      <th>Actors</th>
      <th>Director</th>
      <th>Plot</th>
      <th>Country</th>
      <th>Language</th>
      <th>imdbRating</th>
      <th>BoxOffice</th>
      <th>imdbVotes</th>
      <th>Metascore</th>
      <th>month</th>
      <th>day</th>
      <th>year</th>
      <th>Production Company</th>
      <th>Rated</th>
      <th>Budget</th>
      <th>Keywords</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>If I Want to Whistle, I Whistle</td>
      <td>Drama</td>
      <td>George Pistereanu, Ada Condeescu, Mihai Consta...</td>
      <td>Florin Serban</td>
      <td>Two weeks before his release, a teenage prison...</td>
      <td>Romania, Sweden, Germany</td>
      <td>Romanian</td>
      <td>7.0</td>
      <td>$12,135</td>
      <td>6,424</td>
      <td>64</td>
      <td>january</td>
      <td>5.0</td>
      <td>2011</td>
      <td>Film Movement</td>
      <td>Unrated</td>
      <td>0.0</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Phil Ochs: There but for Fortune</td>
      <td>Documentary, Biography, History</td>
      <td>Salvador Allende, Erik Andersen, Joan Baez</td>
      <td>Kenneth Bowser</td>
      <td>From civil rights to the anti-war movement to ...</td>
      <td>United States</td>
      <td>English</td>
      <td>7.8</td>
      <td>$263,723</td>
      <td>405</td>
      <td>72</td>
      <td>january</td>
      <td>5.0</td>
      <td>2011</td>
      <td>First Run Features</td>
      <td>Unrated</td>
      <td>0.0</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Season of the Witch</td>
      <td>Action, Adventure, Fantasy</td>
      <td>Nicolas Cage, Ron Perlman, Claire Foy</td>
      <td>Dominic Sena</td>
      <td>14th-century knights transport a suspected wit...</td>
      <td>United States</td>
      <td>English, Latin</td>
      <td>5.4</td>
      <td>$24,827,228</td>
      <td>95,932</td>
      <td>28</td>
      <td>january</td>
      <td>7.0</td>
      <td>2011</td>
      <td>Rogue Pictures / Relativity Media</td>
      <td>PG-13</td>
      <td>40000000.0</td>
      <td>[{'id': 344, 'name': 'inquisition'}, {'id': 34...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The Time That Remains</td>
      <td>Drama, History</td>
      <td>Menashe Noy, Elia Suleiman, Baher Agbariya</td>
      <td>Elia Suleiman</td>
      <td>An examination of the creation of the state of...</td>
      <td>France, Belgium, Italy, United Kingdom, United...</td>
      <td>Arabic, Hebrew, English</td>
      <td>7.0</td>
      <td>$32,869</td>
      <td>2,590</td>
      <td>74</td>
      <td>january</td>
      <td>7.0</td>
      <td>2011</td>
      <td>IFC Films</td>
      <td>Not Rated</td>
      <td>6500000.0</td>
      <td>[{'id': 537, 'name': 'palestine'}]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Barney's Version</td>
      <td>Comedy, Drama</td>
      <td>Paul Giamatti, Rosamund Pike, Jake Hoffman</td>
      <td>Richard J. Lewis</td>
      <td>The picaresque and touching story of the polit...</td>
      <td>Italy, Canada</td>
      <td>English, French</td>
      <td>7.3</td>
      <td>$4,439,201</td>
      <td>25,586</td>
      <td>67</td>
      <td>january</td>
      <td>14.0</td>
      <td>2011</td>
      <td>Sony Pictures Classics</td>
      <td>R</td>
      <td>30000000.0</td>
      <td>[{'id': 236, 'name': 'suicide'}, {'id': 931, '...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2807</th>
      <td>The King's Man</td>
      <td>Action, Adventure, Thriller</td>
      <td>Ralph Fiennes, Gemma Arterton, Rhys Ifans</td>
      <td>Matthew Vaughn</td>
      <td>In the early years of the 20th century, the Ki...</td>
      <td>United Kingdom, United States</td>
      <td>English, Latin, German, French, Russian</td>
      <td>6.3</td>
      <td>$37,176,373</td>
      <td>156,453</td>
      <td>44</td>
      <td>december</td>
      <td>22.0</td>
      <td>2021</td>
      <td>20th Century Studios / Marv Studios / TSG Ente...</td>
      <td>R</td>
      <td>100000000.0</td>
      <td>[{'id': 212, 'name': 'london, england'}, {'id'...</td>
    </tr>
    <tr>
      <th>2808</th>
      <td>The Tragedy of Macbeth</td>
      <td>Drama, Mystery, Thriller</td>
      <td>Denzel Washington, Frances McDormand, Alex Has...</td>
      <td>Joel Coen</td>
      <td>A Scottish lord becomes convinced by a trio of...</td>
      <td>United States</td>
      <td>English, Persian</td>
      <td>7.1</td>
      <td>N/A</td>
      <td>36,172</td>
      <td>87</td>
      <td>december</td>
      <td>25.0</td>
      <td>2021</td>
      <td>Apple TV+ / A24 / IAC Films</td>
      <td>R</td>
      <td>0.0</td>
      <td>[{'id': 388, 'name': 'scotland'}, {'id': 1157,...</td>
    </tr>
    <tr>
      <th>2809</th>
      <td>A Journal for Jordan</td>
      <td>Drama</td>
      <td>Michael B. Jordan, Chanté Adams, Jalon Christian</td>
      <td>Denzel Washington</td>
      <td>1st Sgt. Charles Monroe King, before he is kil...</td>
      <td>United States</td>
      <td>English</td>
      <td>5.9</td>
      <td>$6,545,174</td>
      <td>2,367</td>
      <td>42</td>
      <td>december</td>
      <td>25.0</td>
      <td>2021</td>
      <td>Columbia Pictures / Escape Artists / Bron Studios</td>
      <td>PG-13</td>
      <td>0.0</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>2810</th>
      <td>American Underdog</td>
      <td>Biography, Drama, Sport</td>
      <td>Zachary Levi, Anna Paquin, Hayden Zaller</td>
      <td>Andrew Erwin, Jon Erwin</td>
      <td>The story of NFL MVP and Hall of Fame quarterb...</td>
      <td>United States</td>
      <td>English</td>
      <td>7.1</td>
      <td>$26,514,814</td>
      <td>17,228</td>
      <td>53</td>
      <td>december</td>
      <td>25.0</td>
      <td>2021</td>
      <td>Lionsgate</td>
      <td>PG</td>
      <td>0.0</td>
      <td>[{'id': 579, 'name': 'american football'}, {'i...</td>
    </tr>
    <tr>
      <th>2811</th>
      <td>Memoria</td>
      <td>Drama, Mystery, Sci-Fi</td>
      <td>Tilda Swinton, Agnes Brekke, Daniel Giménez Cacho</td>
      <td>Apichatpong Weerasethakul</td>
      <td>A woman from Scotland, while traveling in Colo...</td>
      <td>Colombia, Thailand, France, Germany, Mexico, Q...</td>
      <td>English, Spanish</td>
      <td>6.5</td>
      <td>$52,656</td>
      <td>9,572</td>
      <td>91</td>
      <td>december</td>
      <td>26.0</td>
      <td>2021</td>
      <td>Neon</td>
      <td>PG</td>
      <td>0.0</td>
      <td>[{'id': 155800, 'name': 'atmospheric'}, {'id':...</td>
    </tr>
  </tbody>
</table>
<p>2759 rows × 18 columns</p>
</div></div></div>
</div>
<p>We notice that keywords is formatted awkwardly, so to clean this up a bit, we can unpack the dictionary
that is returned so that we have a list of the key words.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total</span><span class="p">[</span><span class="s1">&#39;Keywords&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">total</span><span class="p">[</span><span class="s1">&#39;Keywords&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">float</span> <span class="k">else</span> <span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>
<span class="n">total</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Title</th>
      <th>Genre</th>
      <th>Actors</th>
      <th>Director</th>
      <th>Plot</th>
      <th>Country</th>
      <th>Language</th>
      <th>imdbRating</th>
      <th>BoxOffice</th>
      <th>imdbVotes</th>
      <th>Metascore</th>
      <th>month</th>
      <th>day</th>
      <th>year</th>
      <th>Production Company</th>
      <th>Rated</th>
      <th>Budget</th>
      <th>Keywords</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>If I Want to Whistle, I Whistle</td>
      <td>Drama</td>
      <td>George Pistereanu, Ada Condeescu, Mihai Consta...</td>
      <td>Florin Serban</td>
      <td>Two weeks before his release, a teenage prison...</td>
      <td>Romania, Sweden, Germany</td>
      <td>Romanian</td>
      <td>7.0</td>
      <td>$12,135</td>
      <td>6,424</td>
      <td>64</td>
      <td>january</td>
      <td>5.0</td>
      <td>2011</td>
      <td>Film Movement</td>
      <td>Unrated</td>
      <td>0.0</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Phil Ochs: There but for Fortune</td>
      <td>Documentary, Biography, History</td>
      <td>Salvador Allende, Erik Andersen, Joan Baez</td>
      <td>Kenneth Bowser</td>
      <td>From civil rights to the anti-war movement to ...</td>
      <td>United States</td>
      <td>English</td>
      <td>7.8</td>
      <td>$263,723</td>
      <td>405</td>
      <td>72</td>
      <td>january</td>
      <td>5.0</td>
      <td>2011</td>
      <td>First Run Features</td>
      <td>Unrated</td>
      <td>0.0</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Season of the Witch</td>
      <td>Action, Adventure, Fantasy</td>
      <td>Nicolas Cage, Ron Perlman, Claire Foy</td>
      <td>Dominic Sena</td>
      <td>14th-century knights transport a suspected wit...</td>
      <td>United States</td>
      <td>English, Latin</td>
      <td>5.4</td>
      <td>$24,827,228</td>
      <td>95,932</td>
      <td>28</td>
      <td>january</td>
      <td>7.0</td>
      <td>2011</td>
      <td>Rogue Pictures / Relativity Media</td>
      <td>PG-13</td>
      <td>40000000.0</td>
      <td>[inquisition, monk, ambush, witch, hero, fight...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The Time That Remains</td>
      <td>Drama, History</td>
      <td>Menashe Noy, Elia Suleiman, Baher Agbariya</td>
      <td>Elia Suleiman</td>
      <td>An examination of the creation of the state of...</td>
      <td>France, Belgium, Italy, United Kingdom, United...</td>
      <td>Arabic, Hebrew, English</td>
      <td>7.0</td>
      <td>$32,869</td>
      <td>2,590</td>
      <td>74</td>
      <td>january</td>
      <td>7.0</td>
      <td>2011</td>
      <td>IFC Films</td>
      <td>Not Rated</td>
      <td>6500000.0</td>
      <td>[palestine]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Barney's Version</td>
      <td>Comedy, Drama</td>
      <td>Paul Giamatti, Rosamund Pike, Jake Hoffman</td>
      <td>Richard J. Lewis</td>
      <td>The picaresque and touching story of the polit...</td>
      <td>Italy, Canada</td>
      <td>English, French</td>
      <td>7.3</td>
      <td>$4,439,201</td>
      <td>25,586</td>
      <td>67</td>
      <td>january</td>
      <td>14.0</td>
      <td>2011</td>
      <td>Sony Pictures Classics</td>
      <td>R</td>
      <td>30000000.0</td>
      <td>[suicide, jealousy, canada, politically incorr...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2807</th>
      <td>The King's Man</td>
      <td>Action, Adventure, Thriller</td>
      <td>Ralph Fiennes, Gemma Arterton, Rhys Ifans</td>
      <td>Matthew Vaughn</td>
      <td>In the early years of the 20th century, the Ki...</td>
      <td>United Kingdom, United States</td>
      <td>English, Latin, German, French, Russian</td>
      <td>6.3</td>
      <td>$37,176,373</td>
      <td>156,453</td>
      <td>44</td>
      <td>december</td>
      <td>22.0</td>
      <td>2021</td>
      <td>20th Century Studios / Marv Studios / TSG Ente...</td>
      <td>R</td>
      <td>100000000.0</td>
      <td>[london, england, spy, world war i, based on c...</td>
    </tr>
    <tr>
      <th>2808</th>
      <td>The Tragedy of Macbeth</td>
      <td>Drama, Mystery, Thriller</td>
      <td>Denzel Washington, Frances McDormand, Alex Has...</td>
      <td>Joel Coen</td>
      <td>A Scottish lord becomes convinced by a trio of...</td>
      <td>United States</td>
      <td>English, Persian</td>
      <td>7.1</td>
      <td>N/A</td>
      <td>36,172</td>
      <td>87</td>
      <td>december</td>
      <td>25.0</td>
      <td>2021</td>
      <td>Apple TV+ / A24 / IAC Films</td>
      <td>R</td>
      <td>0.0</td>
      <td>[scotland, husband wife relationship, ambition...</td>
    </tr>
    <tr>
      <th>2809</th>
      <td>A Journal for Jordan</td>
      <td>Drama</td>
      <td>Michael B. Jordan, Chanté Adams, Jalon Christian</td>
      <td>Denzel Washington</td>
      <td>1st Sgt. Charles Monroe King, before he is kil...</td>
      <td>United States</td>
      <td>English</td>
      <td>5.9</td>
      <td>$6,545,174</td>
      <td>2,367</td>
      <td>42</td>
      <td>december</td>
      <td>25.0</td>
      <td>2021</td>
      <td>Columbia Pictures / Escape Artists / Bron Studios</td>
      <td>PG-13</td>
      <td>0.0</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>2810</th>
      <td>American Underdog</td>
      <td>Biography, Drama, Sport</td>
      <td>Zachary Levi, Anna Paquin, Hayden Zaller</td>
      <td>Andrew Erwin, Jon Erwin</td>
      <td>The story of NFL MVP and Hall of Fame quarterb...</td>
      <td>United States</td>
      <td>English</td>
      <td>7.1</td>
      <td>$26,514,814</td>
      <td>17,228</td>
      <td>53</td>
      <td>december</td>
      <td>25.0</td>
      <td>2021</td>
      <td>Lionsgate</td>
      <td>PG</td>
      <td>0.0</td>
      <td>[american football, biography, los angeles, ca...</td>
    </tr>
    <tr>
      <th>2811</th>
      <td>Memoria</td>
      <td>Drama, Mystery, Sci-Fi</td>
      <td>Tilda Swinton, Agnes Brekke, Daniel Giménez Cacho</td>
      <td>Apichatpong Weerasethakul</td>
      <td>A woman from Scotland, while traveling in Colo...</td>
      <td>Colombia, Thailand, France, Germany, Mexico, Q...</td>
      <td>English, Spanish</td>
      <td>6.5</td>
      <td>$52,656</td>
      <td>9,572</td>
      <td>91</td>
      <td>december</td>
      <td>26.0</td>
      <td>2021</td>
      <td>Neon</td>
      <td>PG</td>
      <td>0.0</td>
      <td>[atmospheric, colombia, bogota, colombia]</td>
    </tr>
  </tbody>
</table>
<p>2759 rows × 18 columns</p>
</div></div></div>
</div>
</section>
</section>
<section id="exploratory-data-analysis-and-visualization-a-class-anchor-id-dataviz-a">
<h3>Exploratory Data Analysis and Visualization  <a class="anchor" id="dataViz"></a><a class="headerlink" href="#exploratory-data-analysis-and-visualization-a-class-anchor-id-dataviz-a" title="Permalink to this heading">#</a></h3>
<p>We are now at the stage where we have processed our data into a usable form. Of course, there will be more processing throughout the rest of this project because we need to tailor the information based on the specific needs of the visualization or the model. In the first part of this analysis and visualization we will take a look at a bunch of different factors and explore the data in our table.</p>
<p>For the data we use in the project, we made a .csv file to store the data because the api calls are constantly changing due to the number of people that interact with IMDB, changing the numbers. As you can see, the tables are identical.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#create a copy of the api data so that we don&#39;t have to keep running it</span>
<span class="n">apiData</span> <span class="o">=</span> <span class="n">total</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">apiData</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Title</th>
      <th>Genre</th>
      <th>Actors</th>
      <th>Director</th>
      <th>Plot</th>
      <th>Country</th>
      <th>Language</th>
      <th>imdbRating</th>
      <th>BoxOffice</th>
      <th>imdbVotes</th>
      <th>Metascore</th>
      <th>month</th>
      <th>day</th>
      <th>year</th>
      <th>Production Company</th>
      <th>Rated</th>
      <th>Budget</th>
      <th>Keywords</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>If I Want to Whistle, I Whistle</td>
      <td>Drama</td>
      <td>George Pistereanu, Ada Condeescu, Mihai Consta...</td>
      <td>Florin Serban</td>
      <td>Two weeks before his release, a teenage prison...</td>
      <td>Romania, Sweden, Germany</td>
      <td>Romanian</td>
      <td>7.0</td>
      <td>$12,135</td>
      <td>6,424</td>
      <td>64</td>
      <td>january</td>
      <td>5.0</td>
      <td>2011</td>
      <td>Film Movement</td>
      <td>Unrated</td>
      <td>0.0</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Phil Ochs: There but for Fortune</td>
      <td>Documentary, Biography, History</td>
      <td>Salvador Allende, Erik Andersen, Joan Baez</td>
      <td>Kenneth Bowser</td>
      <td>From civil rights to the anti-war movement to ...</td>
      <td>United States</td>
      <td>English</td>
      <td>7.8</td>
      <td>$263,723</td>
      <td>405</td>
      <td>72</td>
      <td>january</td>
      <td>5.0</td>
      <td>2011</td>
      <td>First Run Features</td>
      <td>Unrated</td>
      <td>0.0</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Season of the Witch</td>
      <td>Action, Adventure, Fantasy</td>
      <td>Nicolas Cage, Ron Perlman, Claire Foy</td>
      <td>Dominic Sena</td>
      <td>14th-century knights transport a suspected wit...</td>
      <td>United States</td>
      <td>English, Latin</td>
      <td>5.4</td>
      <td>$24,827,228</td>
      <td>95,932</td>
      <td>28</td>
      <td>january</td>
      <td>7.0</td>
      <td>2011</td>
      <td>Rogue Pictures / Relativity Media</td>
      <td>PG-13</td>
      <td>40000000.0</td>
      <td>[inquisition, monk, ambush, witch, hero, fight...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The Time That Remains</td>
      <td>Drama, History</td>
      <td>Menashe Noy, Elia Suleiman, Baher Agbariya</td>
      <td>Elia Suleiman</td>
      <td>An examination of the creation of the state of...</td>
      <td>France, Belgium, Italy, United Kingdom, United...</td>
      <td>Arabic, Hebrew, English</td>
      <td>7.0</td>
      <td>$32,869</td>
      <td>2,590</td>
      <td>74</td>
      <td>january</td>
      <td>7.0</td>
      <td>2011</td>
      <td>IFC Films</td>
      <td>Not Rated</td>
      <td>6500000.0</td>
      <td>[palestine]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Barney's Version</td>
      <td>Comedy, Drama</td>
      <td>Paul Giamatti, Rosamund Pike, Jake Hoffman</td>
      <td>Richard J. Lewis</td>
      <td>The picaresque and touching story of the polit...</td>
      <td>Italy, Canada</td>
      <td>English, French</td>
      <td>7.3</td>
      <td>$4,439,201</td>
      <td>25,586</td>
      <td>67</td>
      <td>january</td>
      <td>14.0</td>
      <td>2011</td>
      <td>Sony Pictures Classics</td>
      <td>R</td>
      <td>30000000.0</td>
      <td>[suicide, jealousy, canada, politically incorr...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>The Dilemma</td>
      <td>Comedy, Drama</td>
      <td>Vince Vaughn, Kevin James, Winona Ryder</td>
      <td>Ron Howard</td>
      <td>A man discovers that his best friend's wife is...</td>
      <td>United States</td>
      <td>English</td>
      <td>5.3</td>
      <td>$48,475,290</td>
      <td>55,332</td>
      <td>46</td>
      <td>january</td>
      <td>14.0</td>
      <td>2011</td>
      <td>Universal Pictures / Imagine Entertainment / S...</td>
      <td>PG-13</td>
      <td>70000000.0</td>
      <td>[adultery, infidelity, bachelor, wife, investi...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>The Green Hornet</td>
      <td>Action, Comedy, Crime</td>
      <td>Seth Rogen, Jay Chou, Christoph Waltz</td>
      <td>Michel Gondry</td>
      <td>Following the death of his father, Britt Reid,...</td>
      <td>United States</td>
      <td>English, Mandarin</td>
      <td>5.8</td>
      <td>$98,780,042</td>
      <td>162,350</td>
      <td>39</td>
      <td>january</td>
      <td>14.0</td>
      <td>2011</td>
      <td>Columbia Pictures / Original Film</td>
      <td>PG-13</td>
      <td>120000000.0</td>
      <td>[bomb, martial arts, assassin, vandalism, nigh...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>No Strings Attached</td>
      <td>Comedy, Romance</td>
      <td>Natalie Portman, Ashton Kutcher, Kevin Kline</td>
      <td>Ivan Reitman</td>
      <td>A guy and girl try to keep their relationship ...</td>
      <td>United States, United Kingdom</td>
      <td>English, Ukrainian</td>
      <td>6.2</td>
      <td>$70,662,220</td>
      <td>236,097</td>
      <td>50</td>
      <td>january</td>
      <td>21.0</td>
      <td>2011</td>
      <td>Paramount Pictures / The Montecito Picture Com...</td>
      <td>R</td>
      <td>25000000.0</td>
      <td>[parent child relationship, casual meeting, st...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Open Season 3</td>
      <td>Animation, Adventure, Comedy</td>
      <td>Matthew J. Munn, Nika Futterman, Maddie Taylor</td>
      <td>Cody Cameron</td>
      <td>Boog's friends rally to bring him home from a ...</td>
      <td>United States, Canada</td>
      <td>English</td>
      <td>5.0</td>
      <td>N/A</td>
      <td>12,362</td>
      <td>N/A</td>
      <td>january</td>
      <td>25.0</td>
      <td>2011</td>
      <td>Sony Pictures Home Entertainment / Sony Pictur...</td>
      <td>PG</td>
      <td>0.0</td>
      <td>[circus, friendship, deer, bear, look-alike, f...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>The Mechanic</td>
      <td>Action, Crime, Thriller</td>
      <td>Jason Statham, Ben Foster, Donald Sutherland</td>
      <td>Simon West</td>
      <td>An elite hitman teaches his trade to an appren...</td>
      <td>United States</td>
      <td>English</td>
      <td>6.5</td>
      <td>$29,121,498</td>
      <td>164,471</td>
      <td>49</td>
      <td>january</td>
      <td>28.0</td>
      <td>2011</td>
      <td>CBS Films</td>
      <td>R</td>
      <td>40000000.0</td>
      <td>[poison, chicago, illinois, prostitute, martia...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in the csv file of the data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;fixedData.csv&quot;</span><span class="p">)</span>

<span class="c1">#create a copy for later use</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>index</th>
      <th>Title</th>
      <th>Genre</th>
      <th>Actors</th>
      <th>Director</th>
      <th>Plot</th>
      <th>Country</th>
      <th>Language</th>
      <th>imdbRating</th>
      <th>BoxOffice</th>
      <th>imdbVotes</th>
      <th>Metascore</th>
      <th>month</th>
      <th>day</th>
      <th>year</th>
      <th>Production Company</th>
      <th>Rated</th>
      <th>Budget</th>
      <th>Keywords</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>If I Want to Whistle, I Whistle</td>
      <td>Drama</td>
      <td>George Pistereanu, Ada Condeescu, Mihai Consta...</td>
      <td>Florin Serban</td>
      <td>Two weeks before his release, a teenage prison...</td>
      <td>Romania, Sweden, Germany</td>
      <td>Romanian</td>
      <td>7.0</td>
      <td>$12,135</td>
      <td>6,424</td>
      <td>64.0</td>
      <td>january</td>
      <td>5.0</td>
      <td>2011</td>
      <td>Film Movement</td>
      <td>Unrated</td>
      <td>0.0</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>Phil Ochs: There but for Fortune</td>
      <td>Documentary, Biography, History</td>
      <td>Salvador Allende, Erik Andersen, Joan Baez</td>
      <td>Kenneth Bowser</td>
      <td>From civil rights to the anti-war movement to ...</td>
      <td>United States</td>
      <td>English</td>
      <td>7.8</td>
      <td>$263,723</td>
      <td>405</td>
      <td>72.0</td>
      <td>january</td>
      <td>5.0</td>
      <td>2011</td>
      <td>First Run Features</td>
      <td>Unrated</td>
      <td>0.0</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2</td>
      <td>Season of the Witch</td>
      <td>Action, Adventure, Fantasy</td>
      <td>Nicolas Cage, Ron Perlman, Claire Foy</td>
      <td>Dominic Sena</td>
      <td>14th-century knights transport a suspected wit...</td>
      <td>United States</td>
      <td>English, Latin</td>
      <td>5.4</td>
      <td>$24,827,228</td>
      <td>95,708</td>
      <td>28.0</td>
      <td>january</td>
      <td>7.0</td>
      <td>2011</td>
      <td>Rogue Pictures / Relativity Media</td>
      <td>PG-13</td>
      <td>40000000.0</td>
      <td>['inquisition', 'monk', 'ambush', 'witch', 'he...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>3</td>
      <td>The Time That Remains</td>
      <td>Drama, History</td>
      <td>Menashe Noy, Elia Suleiman, Baher Agbariya</td>
      <td>Elia Suleiman</td>
      <td>An examination of the creation of the state of...</td>
      <td>France, Belgium, Italy, United Kingdom, United...</td>
      <td>Arabic, Hebrew, English</td>
      <td>7.0</td>
      <td>$32,869</td>
      <td>2,590</td>
      <td>74.0</td>
      <td>january</td>
      <td>7.0</td>
      <td>2011</td>
      <td>IFC Films</td>
      <td>Not Rated</td>
      <td>6500000.0</td>
      <td>['palestine']</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>4</td>
      <td>Barney's Version</td>
      <td>Comedy, Drama</td>
      <td>Paul Giamatti, Rosamund Pike, Jake Hoffman</td>
      <td>Richard J. Lewis</td>
      <td>The picaresque and touching story of the polit...</td>
      <td>Italy, Canada</td>
      <td>English, French</td>
      <td>7.3</td>
      <td>$4,439,201</td>
      <td>25,586</td>
      <td>67.0</td>
      <td>january</td>
      <td>14.0</td>
      <td>2011</td>
      <td>Sony Pictures Classics</td>
      <td>R</td>
      <td>30000000.0</td>
      <td>['suicide', 'jealousy', 'canada', 'politically...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>5</td>
      <td>The Dilemma</td>
      <td>Comedy, Drama</td>
      <td>Vince Vaughn, Kevin James, Winona Ryder</td>
      <td>Ron Howard</td>
      <td>A man discovers that his best friend's wife is...</td>
      <td>United States</td>
      <td>English</td>
      <td>5.3</td>
      <td>$48,475,290</td>
      <td>55,332</td>
      <td>46.0</td>
      <td>january</td>
      <td>14.0</td>
      <td>2011</td>
      <td>Universal Pictures / Imagine Entertainment / S...</td>
      <td>PG-13</td>
      <td>70000000.0</td>
      <td>['adultery', 'infidelity', 'bachelor', 'wife',...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>6</td>
      <td>The Green Hornet</td>
      <td>Action, Comedy, Crime</td>
      <td>Seth Rogen, Jay Chou, Christoph Waltz</td>
      <td>Michel Gondry</td>
      <td>Following the death of his father, Britt Reid,...</td>
      <td>United States</td>
      <td>English, Mandarin</td>
      <td>5.8</td>
      <td>$98,780,042</td>
      <td>162,350</td>
      <td>39.0</td>
      <td>january</td>
      <td>14.0</td>
      <td>2011</td>
      <td>Columbia Pictures / Original Film</td>
      <td>PG-13</td>
      <td>120000000.0</td>
      <td>['bomb', 'martial arts', 'assassin', 'vandalis...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>7</td>
      <td>No Strings Attached</td>
      <td>Comedy, Romance</td>
      <td>Natalie Portman, Ashton Kutcher, Kevin Kline</td>
      <td>Ivan Reitman</td>
      <td>A guy and girl try to keep their relationship ...</td>
      <td>United States, United Kingdom</td>
      <td>English, Ukrainian</td>
      <td>6.2</td>
      <td>$70,662,220</td>
      <td>236,097</td>
      <td>50.0</td>
      <td>january</td>
      <td>21.0</td>
      <td>2011</td>
      <td>Paramount Pictures / The Montecito Picture Com...</td>
      <td>R</td>
      <td>25000000.0</td>
      <td>['parent child relationship', 'casual meeting'...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>8</td>
      <td>Open Season 3</td>
      <td>Animation, Adventure, Comedy</td>
      <td>Matthew J. Munn, Nika Futterman, Maddie Taylor</td>
      <td>Cody Cameron</td>
      <td>Boog's friends rally to bring him home from a ...</td>
      <td>United States, Canada</td>
      <td>English</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>12,362</td>
      <td>NaN</td>
      <td>january</td>
      <td>25.0</td>
      <td>2011</td>
      <td>Sony Pictures Home Entertainment / Sony Pictur...</td>
      <td>PG</td>
      <td>0.0</td>
      <td>['circus', 'friendship', 'deer', 'bear', 'look...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>9</td>
      <td>The Mechanic</td>
      <td>Action, Crime, Thriller</td>
      <td>Jason Statham, Ben Foster, Donald Sutherland</td>
      <td>Simon West</td>
      <td>An elite hitman teaches his trade to an appren...</td>
      <td>United States</td>
      <td>English</td>
      <td>6.5</td>
      <td>$29,121,498</td>
      <td>164,471</td>
      <td>49.0</td>
      <td>january</td>
      <td>28.0</td>
      <td>2011</td>
      <td>CBS Films</td>
      <td>R</td>
      <td>40000000.0</td>
      <td>['poison', 'chicago, illinois', 'prostitute', ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><b>Processing Box Office and Month Columns</b></p>
<p>In this raw data from the API, the BoxOffice and imdbVotes columns are represented as strings. Additionally, the BoxOffice columns are prepended with a $ sign and have commas indicating thousands of dollars. We remove these symbols and convert both these columns into floats, as we will be applying mathematical functions to them later. Additionally, the months are listed in word format (ie January, Feburary, ..) rather than in numerical format (ie 1,2,3…). We convert these strings to numbers using the <a class="reference external" href="https://docs.python.org/3/library/datetime.htmldatetime">datetime import</a>, mapping January → 1, Feburary → 2, and so on.</p>
<p><b>Creating Hit Column</b></p>
<p>In addition to the dataframe columns we have, we add a new column called “hit.” This column denotes movies as a hit (with a 1 in the column) if the imdbRating for that movie is &gt; 6.5 or a non-hit (with a 0 in the column) if the imdbRating for that movie is &lt; 6.5. We decided on using 6.5 as our hit differentiator, as that is the average imdbRating for all the movies in the dataframe. This coulmn will be used later on for our classification model!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="c1">#drop NA columns</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Rated&quot;</span><span class="p">])</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;BoxOffice&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">)]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Budget&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">]</span> 

<span class="c1">#change the formatting of the Box office and imdb votes columns to remove the comma and dollar sign </span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;imdbRating&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;BoxOffice&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;BoxOffice&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;$&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;BoxOffice&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;BoxOffice&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;imdbVotes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;imdbVotes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">))</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s2">&quot;BoxOffice&quot;</span><span class="p">:</span><span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s2">&quot;imdbVotes&quot;</span><span class="p">:</span><span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s2">&quot;imdbRating&quot;</span><span class="p">:</span><span class="s1">&#39;float&#39;</span> <span class="p">})</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;%B&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>

<span class="n">data</span><span class="p">[</span><span class="s2">&quot;hit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span> <span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;imdbRating&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">6.5</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;imdbVotes&quot;</span><span class="p">]</span> <span class="o">&gt;</span><span class="mi">500</span>  <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="initial-visualizations-a-class-anchor-id-initialviz-a">
<h4>Initial Visualizations  <a class="anchor" id="initialViz"></a><a class="headerlink" href="#initial-visualizations-a-class-anchor-id-initialviz-a" title="Permalink to this heading">#</a></h4>
<p>First, it would be interesting to see the box office of movies at different months throughout the year. It is generally known that the summer months and the november-december are considered the <a class="reference external" href="https://runpee.com/wide-release-movie-count-by-month/#:~:text=You%20can%20see%20that%20April,movies%20released%20during%20those%20months.">best time</a> to release movies as the audience is the largest during this time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#select the month and box office columns</span>
<span class="n">month</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;BoxOffice&#39;</span><span class="p">]]</span>
<span class="n">month</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>month</th>
      <th>BoxOffice</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>944</th>
      <td>11</td>
      <td>188020017.0</td>
    </tr>
    <tr>
      <th>928</th>
      <td>10</td>
      <td>13092000.0</td>
    </tr>
    <tr>
      <th>2005</th>
      <td>7</td>
      <td>422783777.0</td>
    </tr>
    <tr>
      <th>1867</th>
      <td>12</td>
      <td>190241310.0</td>
    </tr>
    <tr>
      <th>730</th>
      <td>11</td>
      <td>707481.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>178</th>
      <td>11</td>
      <td>74158157.0</td>
    </tr>
    <tr>
      <th>1776</th>
      <td>8</td>
      <td>30569484.0</td>
    </tr>
    <tr>
      <th>921</th>
      <td>10</td>
      <td>14019924.0</td>
    </tr>
    <tr>
      <th>2118</th>
      <td>12</td>
      <td>27166770.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2</td>
      <td>73013910.0</td>
    </tr>
  </tbody>
</table>
<p>1509 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#groupby the month to get unique months and plot the box office for each month</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">month</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;month&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Average Box Office by Month&#39;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Box Office&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Box Office&#39;)
</pre></div>
</div>
<img alt="_images/41ab637bdd4e9532bf675a265219e9d0a7dd169b4591093f932123016245953f.png" src="_images/41ab637bdd4e9532bf675a265219e9d0a7dd169b4591093f932123016245953f.png" />
</div>
</div>
<p>As we can see, we got the expected results. The summer months and the end of the year are the best months for box office. We now have one component that contributes to the success of a movie. Now, lets take a look at the year and how it relates to box office success.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#group by year to find out if there is a correlation between year and box office</span>
<span class="n">yearData</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;BoxOffice&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">yearData</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;year&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">y</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Average Box Office by Year&#39;</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Box Office&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Box Office&#39;)
</pre></div>
</div>
<img alt="_images/83a06b722b17d37f93a39c9bc080143946fe518e87471c929aeb49f71142cac6.png" src="_images/83a06b722b17d37f93a39c9bc080143946fe518e87471c929aeb49f71142cac6.png" />
</div>
</div>
<p>This graph is not too surprising, but there is clearly an effect of the pandemic on movies where box office earnings have plummeted. Other than this, box office earnings have gone up every year. Now, lets look at the total profit and how it changes based on month.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#plots the profit per month</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Profit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;BoxOffice&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Budget&#39;</span><span class="p">]</span> 
<span class="n">monthlyProfit</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;Profit&#39;</span><span class="p">]]</span>
<span class="n">monthlyProfit</span> <span class="o">=</span> <span class="n">monthlyProfit</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;month&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">monthlyProfit</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Average Profit by Month&#39;</span><span class="p">)</span>
<span class="n">monthlyProfit</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">)</span>
<span class="n">monthlyProfit</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Profit&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Profit&#39;)
</pre></div>
</div>
<img alt="_images/be9f061fc532f1e576f7a3d3d460c744ea2124361a7f6d8dbd8979f3e88514c7.png" src="_images/be9f061fc532f1e576f7a3d3d460c744ea2124361a7f6d8dbd8979f3e88514c7.png" />
</div>
</div>
<p>It seems like the profit is dependent on month as well, as this graph’s peaks are similar to the box office graph. A month feature would be interesting to look at to calculate whether a movie will be a hit. Another thing to analyze could be the relation between the box office and the aggregate number of imdb votes on the movie.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1">#create subplots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">rateData</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;Rated&#39;</span><span class="p">,</span> <span class="s1">&#39;BoxOffice&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">rateData</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Rated&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1">#barplots using average and sum of box office</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="s1">&#39;BoxOffice&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Average Box Office by Rating&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Rating&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Box Office&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;right&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">rateData</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Rated&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">z</span><span class="p">[</span><span class="s1">&#39;BoxOffice&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Total Box Office by Rating&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Rating&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Box Office&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;right&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
 [Text(0, 0, &#39;&#39;),
  Text(0, 0, &#39;&#39;),
  Text(0, 0, &#39;&#39;),
  Text(0, 0, &#39;&#39;),
  Text(0, 0, &#39;&#39;),
  Text(0, 0, &#39;&#39;),
  Text(0, 0, &#39;&#39;),
  Text(0, 0, &#39;&#39;),
  Text(0, 0, &#39;&#39;),
  Text(0, 0, &#39;&#39;),
  Text(0, 0, &#39;&#39;)])
</pre></div>
</div>
<img alt="_images/b4705598a289e8194ae7f51b014f048e369d45949accfdb41a791afc64e15bf5.png" src="_images/b4705598a289e8194ae7f51b014f048e369d45949accfdb41a791afc64e15bf5.png" />
</div>
</div>
<p>Here is a comparison of two plots. The first one is the average box office of rating. The “G” rating produces the highest box office, followed by the “PG” rating, and then the “PG-13” rating. However, the total box office for G movies is not even comparable to that of PG-13. Nevertheless, we have acquired vital information about another factor in determining whether a movie is a hit or not: rating.</p>
<p>Lastly, we will look at ratings and votes by fans and their relation to the box office. First, I’ll define a couple of terms. A <a class="reference external" href="https://www.freecodecamp.org/news/whose-reviews-should-you-trust-imdb-rotten-tomatoes-metacritic-or-fandango-7d1010c6cf19/#:~:text=In%20a%20nutshell%2C%20the%20metascore,about%20their%20rating%20system%20here.">metascore</a> is a weighted average of many reviews coming from reputed critics. It is scored from 0 - 100. The <a class="reference external" href="https://www.imdb.com/">IMDB Rating</a> is an aggregation of user reviews, which is then averaged. IMDB votes are the sum of the amount of votes that users cast for a particular movie.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1">#subplots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Metascore&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;BoxOffice&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Average Box Office by Metascore&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Metascore&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Box Office&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;imdbRating&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;BoxOffice&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Average Box Office by IMDB Rating&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;IMDB Rating&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Box Office&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Box Office&#39;)
</pre></div>
</div>
<img alt="_images/ce58b48319e39dc4a5262473d3b990fc41b92c2a84702d407ba86682aafdc332.png" src="_images/ce58b48319e39dc4a5262473d3b990fc41b92c2a84702d407ba86682aafdc332.png" />
</div>
</div>
<p>Although there is not a perfect correlation between these ratings and box office, we can point out some observations from these graphs. A movie with a large box office is generally on the higher side of the imdbRating scale. However, this does not seem to be the case with the metascore, where there are movies that have yielded a box office of more than $60,000,000 that have a mediocre metascore rating. All in all, we can take a look at all of these factors and try to come up with a way to determine whether a movie is a hit or not.</p>
</section>
</section>
<section id="model-analysis-hypothesis-testing-ml-a-class-anchor-id-ml-a">
<h3>Model: Analysis, Hypothesis Testing, &amp; ML  <a class="anchor" id="ml"></a><a class="headerlink" href="#model-analysis-hypothesis-testing-ml-a-class-anchor-id-ml-a" title="Permalink to this heading">#</a></h3>
<p>In the data visualizations above, we analyze the different relationships that features such as month and rating have on Box Office. Now that we have visualized and discussed these trends, we proceed to analyze how the features listed above and more impact public perception through imdbRating via machine learning techniques. We utilize multiple ML classification algorithms, and compare their key statistics to see which one bets classifies our dataset.</p>
<p>Do you ever hear about the highest grossing box office movies, but wonder whether the audience genuinley enjoyed it?
Or whether movie critics are actually reliable sources in determining public perception of movies?
How about whether the month a movie releases has an impact on whether people like that movie or not?</p>
<p>Using the features listed above and some others detailed below, we attempt to classify whether a movie is a hit or not. While there is no univeral definition for what classifies a hit film, we define it to be an imdbRating of over 6.5, which is significantly above average, with over 500 imdbVotes. This removes films that might have only a few ratings, which would skew the data.</p>
<p>Because we are interested in applying a label as an output, we decided to use a classification model rather than a regression model, which is generally used for predicting a quantity. More information on the difference between these two types of models can be found <a class="reference external" href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#all necessary imports</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span> 
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span> 
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">f1_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>


<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span> 

<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">ConfusionMatrixDisplay</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">RandomizedSearchCV</span><span class="p">,</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">randint</span>
</pre></div>
</div>
</div>
</div>
<p><b>Processing Data through One-Hot Encoding</b></p>
<p>Before we explain one-hot encoding, it’s important to recognize what <a class="reference external" href="https://en.wikipedia.org/wiki/Categorical_variable">categorical data</a> is. In statistics, a categorical variable is a variable that can take on a number of possible values, each assigned to a specific group. In our project, a categorical variable could the genre (Comedy, Action, etc.) or rating(PG-13, R, etc.) of the movie. The issue with this kind of data is that many machine learning algorithms cannot operate on labeled data directly, as inputs and outputs must be numeric. This is where <a class="reference external" href="https://en.wikipedia.org/wiki/Categorical_variable">one-hot encoding</a> is useful. It allows us to represent categorical variables as numerical values in a model. The categorical parameters will prepare separate columns for each individual label. For example, whenever there is a comedy movie, the value will be 1 in the new “Comedy” column and 0s for all the other columns. Here is a link to more information on one-hot encoding: <a class="reference external" href="https://hackernoon.com/what-is-one-hot-encoding-why-and-when-do-you-have-to-use-it-e3c6186d008f">What is One Hot Encoding?</a></p>
<p>For our data, there are problems beyond just categorical data that require processing. The genre labeling that is returned by the API lists some of the genres as a combination of multiple genres. There are many entries that look like “comedy, action.” Movies with this genre must be listed in the “comedy” and “action” columns as 1s in the processed table. We do this by first extracting all the unique genres in the dataframe, making each a new column, and adding a 1 whenever a given movie has that genre in the list of genres or a 0 otherwise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#create a dictionary with unique genres</span>
<span class="n">all_generes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span> 
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Genre&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">genre</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">genre</span><span class="p">:</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">all_generes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

<span class="c1">#one-hot encoding</span>
<span class="k">for</span> <span class="n">genre</span> <span class="ow">in</span> <span class="n">all_generes</span><span class="p">:</span>
     <span class="n">data</span><span class="p">[</span><span class="n">genre</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Genre&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">genre</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
    
<span class="n">all_ratings</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span> 
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Rated&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">all_ratings</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    
<span class="c1">#one-hot encode the ratings</span>
<span class="k">for</span> <span class="n">rat</span> <span class="ow">in</span> <span class="n">all_ratings</span><span class="p">:</span>
     <span class="n">data</span><span class="p">[</span><span class="n">rat</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Rated&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">rat</span> <span class="o">==</span> <span class="n">x</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        
<span class="n">all_ratings</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_ratings</span><span class="p">)</span>
<span class="n">all_generes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_generes</span><span class="p">)</span>

<span class="c1">#add columns</span>
<span class="n">lst</span> <span class="o">=</span> <span class="n">all_ratings</span><span class="o">+</span> <span class="n">all_generes</span>  <span class="o">+</span><span class="p">[</span> <span class="s2">&quot;Budget&quot;</span><span class="p">,</span><span class="s2">&quot;BoxOffice&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;Metascore&quot;</span><span class="p">]</span>


<span class="n">data</span><span class="p">[</span><span class="n">lst</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>G</th>
      <th>PG</th>
      <th>TV-MA</th>
      <th>Approved</th>
      <th>Unrated</th>
      <th>R</th>
      <th>NC-17</th>
      <th>PG-13</th>
      <th>Not Rated</th>
      <th>TV-14</th>
      <th>...</th>
      <th>Family</th>
      <th>Biography</th>
      <th>Western</th>
      <th>Adventure</th>
      <th>Sci-Fi</th>
      <th>Mystery</th>
      <th>Budget</th>
      <th>BoxOffice</th>
      <th>month</th>
      <th>Metascore</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>944</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>165000000.0</td>
      <td>188020017.0</td>
      <td>11</td>
      <td>74.0</td>
    </tr>
    <tr>
      <th>928</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3300000.0</td>
      <td>13092000.0</td>
      <td>10</td>
      <td>89.0</td>
    </tr>
    <tr>
      <th>2005</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>45000000.0</td>
      <td>422783777.0</td>
      <td>7</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>1867</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>90000000.0</td>
      <td>190241310.0</td>
      <td>12</td>
      <td>87.0</td>
    </tr>
    <tr>
      <th>730</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>30000000.0</td>
      <td>707481.0</td>
      <td>11</td>
      <td>77.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 36 columns</p>
</div></div></div>
</div>
<section id="preliminary-exploration-of-data-for-the-model-a-class-anchor-id-preliminary-a">
<h4>Preliminary Exploration of Data for the Model  <a class="anchor" id="preliminary"></a><a class="headerlink" href="#preliminary-exploration-of-data-for-the-model-a-class-anchor-id-preliminary-a" title="Permalink to this heading">#</a></h4>
<p>We first begin with extrapolating the different features we will put into the model. From the data we explored above, we decided to explore this classification using Metascore, Budget, Box Office, month, genre, and rating (R, PG-13…) as features. While our dataframe contains other information such as actors, production company, and plot, we realize that it is simply impractical to include this information in our model as there are far too many actors and production companies that have been involved in the provided movies. We instead use this information for the movie recommender in the next section!</p>
<p>First, we visualize which Ratings and which Genres have the most hits with the two pie charts below. We see that rated R movies have the highest percentage of hits, followed by PG-13. Additionally, we notice that Drama movies and Comedy movies have the highest percentage of hits, closely followed by Action and Adventure movies.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">hits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;hit&quot;</span><span class="p">])</span>
<span class="c1">#get the unique ratings</span>
<span class="n">ratings</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Rated&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ratings</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;hit&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)])</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="o">/</span><span class="n">hits</span>
<span class="n">h</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Ratings&quot;</span><span class="p">,</span> <span class="s2">&quot;Percent&quot;</span><span class="p">])</span>

<span class="n">pal_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">palette</span><span class="o">=</span><span class="s1">&#39;plasma_r&#39;</span><span class="p">,</span>
                              <span class="n">n_colors</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">ratings</span><span class="p">))</span><span class="o">.</span><span class="n">as_hex</span><span class="p">())</span>
<span class="c1">#plot a pie chart for ratings by percentage</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Percent</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Ratings</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="n">pal_</span><span class="p">,</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="n">pctdistance</span><span class="o">=</span><span class="mf">.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9b2d2417766bbfb2472b4795b56753ce9bb6751dcf0903e03fcf74d3b91a8a87.png" src="_images/9b2d2417766bbfb2472b4795b56753ce9bb6751dcf0903e03fcf74d3b91a8a87.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">hits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;hit&quot;</span><span class="p">])</span>
<span class="n">ratings</span> <span class="o">=</span> <span class="n">all_generes</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ratings</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;hit&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)])</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="o">/</span><span class="n">hits</span>
<span class="n">h</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Genre&quot;</span><span class="p">,</span> <span class="s2">&quot;Percent&quot;</span><span class="p">])</span>

<span class="n">pal_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">palette</span><span class="o">=</span><span class="s1">&#39;plasma_r&#39;</span><span class="p">,</span>
                              <span class="n">n_colors</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">ratings</span><span class="p">))</span><span class="o">.</span><span class="n">as_hex</span><span class="p">())</span>
<span class="c1">#plot a pie chart for genre by percentage</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Percent</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Genre</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="n">pal_</span><span class="p">,</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="n">pctdistance</span><span class="o">=</span><span class="mf">.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f7408fd2938182ab39debffccc89dc2c9b4b3247e27e48d0fbff7916fddd967a.png" src="_images/f7408fd2938182ab39debffccc89dc2c9b4b3247e27e48d0fbff7916fddd967a.png" />
</div>
</div>
</section>
<section id="feature-importance-a-class-anchor-id-feature-a">
<h4>Feature Importance  <a class="anchor" id="feature"></a><a class="headerlink" href="#feature-importance-a-class-anchor-id-feature-a" title="Permalink to this heading">#</a></h4>
<p>We further analyze just how impactful each genre and each rating is by determining how important each feature is to having a hit movie. We do this by running a RandomForestClassifier, one of the most popular feature importance techniques.</p>
<p>The algorithm involves constructing decision trees for each sample and generating output based off this tree. The final output is a majority vote on whether the trees resulted in a 1 or 0, in this case a hit or not. To learn more about RandomForestClassification and its use on finding feature importance, please refer to this resource <a class="reference external" href="https://www.analyticsvidhya.com/blog/2021/06/understanding-random-forest/#:~:text=Random%20forest%20algorithm%20is%20an,both%20classification%20and%20regression%20problems.">here</a>.
The feature with the largest importance is Metascore, followed by Box Office, Budget, and month.</p>
<p>The bar graphs below show the importance of each feature we use in our classification. Surprisingly, the movie pundits might be onto something, as the Metascore has the highest importance out of all the features we analyze. The second and third highest importance are the BoxOffice and Budget respectivly. This also aligns with what we expected, as when referencing popular movies, we tend to reference movies that are BoxOffice hits and have large production budgets. Additionally, as shown in the bar plot in the Visualization section, the month has a realtivley high feature importance on whether a movie is a hit or a flop. From there, we noticed that each genre and rating had a reduced feature importance in comparision to the aforementioned four features. This is because each genre and rating is considered its own feature, rather than collectivley determining the feature importance for genres and ratings. The importance of genres as a whole and ratings is shown in the second bar plot, which displays that genres actually have the second highest feature importance out of the given features.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tot</span> <span class="o">=</span> <span class="n">lst</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;hit&quot;</span><span class="p">]</span> 
<span class="c1">#drop columns</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="n">tot</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">lst</span><span class="p">]</span>
<span class="n">X</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="c1">#use random forest classifier to view feature importance</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;hit&quot;</span><span class="p">]</span>
<span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">150</span><span class="p">)</span> 
<span class="n">rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> 
<span class="n">sort</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">sort</span><span class="p">],</span> <span class="n">rf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">[</span><span class="n">sort</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Importance of Features using RFC&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Feature Importance&quot;</span><span class="p">)</span>

<span class="c1">#sort by most important</span>
<span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">sort</span><span class="p">]</span>
<span class="n">rf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">[</span><span class="n">sort</span><span class="p">]</span>
<span class="n">all_features</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">sort</span><span class="p">])):</span>
    <span class="n">all_features</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">sort</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">[</span><span class="n">sort</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c3409a0a86f62edea05eadb98753e28bfdbeddb49ea7ab3d30c4af97ebe15079.png" src="_images/c3409a0a86f62edea05eadb98753e28bfdbeddb49ea7ab3d30c4af97ebe15079.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_features</span><span class="p">[</span><span class="s2">&quot;genres&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">all_features</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">all_generes</span><span class="p">:</span>
        <span class="n">all_features</span><span class="p">[</span><span class="s2">&quot;genres&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">float</span><span class="p">(</span><span class="n">all_features</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">all_generes</span><span class="p">:</span>
    <span class="k">del</span> <span class="n">all_features</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">all_features</span>

<span class="n">all_features</span><span class="p">[</span><span class="s2">&quot;ratings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">all_features</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">all_ratings</span><span class="p">:</span>
        <span class="n">all_features</span><span class="p">[</span><span class="s2">&quot;ratings&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">float</span><span class="p">(</span><span class="n">all_features</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">all_ratings</span><span class="p">:</span>
    <span class="k">del</span> <span class="n">all_features</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">all_features</span>

<span class="c1">#plot feature importance</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_features</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_features</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_features</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_features</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s1">&#39;right&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Feature Importance&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Feature Importance&#39;)
</pre></div>
</div>
<img alt="_images/21662966de1b433967586b906b7d95e3ab249a16a712b18e15e714df31bdc254.png" src="_images/21662966de1b433967586b906b7d95e3ab249a16a712b18e15e714df31bdc254.png" />
</div>
</div>
<p>Now that we confirmed that the features we hypothesized would have an impact on movie success, we run 3 different classification algorithms to determine whether we can correctly predict whether a movie would be a hit or not. We first split 80% of our data into a training set, and allocate the remaining 20 as the testing set. To determine which of the classification algorithms perform the best, we compare the <a class="reference external" href="https://saifmorahman.medium.com/interpreting-accuracy-precision-recall-and-f1-score-metrics-46bba7f00b2c#:~:text=The%20accuracy%20metric%20is%20the,total%20number%20of%20data%20points.">accuracy score</a>, which takes the total number of correctly predicted data points and divides it by the total number of data points. Another metric we use in determining the validity of the models is the <a class="reference external" href="https://saifmorahman.medium.com/interpreting-accuracy-precision-recall-and-f1-score-metrics-46bba7f00b2c#:~:text=The%20accuracy%20metric%20is%20the,total%20number%20of%20data%20points.">f1 score</a>, which takes the weighted average of precision and recall. It has more of a focus on false negatives and false positives. We additionally display the confusion matrix which displays the number of correct predictions, the number of Type 1 error predictions, and the number Type 2 error predictions. The formulas for both metrics and a description of the confusion matrix are detailed below.
<img alt="accuracy" src="https://www.nomidl.com/wp-content/uploads/2022/02/image-13.png" />
<img alt="f1score" src="https://miro.medium.com/v2/resize:fit:1400/1*5_ZAlFhlCk8llhnYWD5PXw.png" />
<img alt="confusion matrix" src="https://glassboxmedicine.files.wordpress.com/2019/02/confusion-matrix.png?w=816" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Run for all data </span>
<span class="n">lst</span> <span class="o">=</span> <span class="n">all_ratings</span><span class="o">+</span> <span class="n">all_generes</span>  <span class="o">+</span><span class="p">[</span> <span class="s2">&quot;Budget&quot;</span><span class="p">,</span><span class="s2">&quot;BoxOffice&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;Metascore&quot;</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">lst</span><span class="p">]</span> 
<span class="n">X</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;hit&quot;</span><span class="p">]</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="k-nearest-neighbors-a-class-anchor-id-knn-a">
<h4>K Nearest Neighbors  <a class="anchor" id="knn"></a><a class="headerlink" href="#k-nearest-neighbors-a-class-anchor-id-knn-a" title="Permalink to this heading">#</a></h4>
<p>The first model we run is a K Nearest Neighbor Classifier (KNN). This classifier computes the euclidean distance between the test point and all the other data points and compares the K nearest neighbors to see whether to classify the test point as a 1 or 0. More information on the KNN model can be found <a class="reference external" href="https://www.ibm.com/topics/knn#:~:text=Next%20steps-,K%2DNearest%20Neighbors%20Algorithm,of%20an%20individual%20data%20point.">here</a>. After trial and error and reading reputable <a class="reference external" href="https://towardsdatascience.com/a-simple-introduction-to-k-nearest-neighbors-algorithm-b3519ed98e">sources</a> We take K to be the sqrt of the number of data points we have.</p>
<p>Our accuracy score for the KNN model is ~ 70.80% which for a real-world data set is very good. According to the <a class="reference external" href="https://stephenallwright.com/good-accuracy-score/#:~:text=There%20is%20a%20general%20rule,60%25%20and%2070%25%20%2D%20OK">data science community</a> an accuracy score of above ~70% is considered good. However, the f1 score, ~67.89%, is realtively low for the KNN model, and the confusion matrix shows clarity as to why. The model has a higher amount of false positives, perhaps because there are more non-hit movies than hit movies.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#use the standard scalar and predict using KNN</span>
<span class="n">sc_X</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span> 
<span class="n">X_train</span> <span class="o">=</span> <span class="n">sc_X</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span> 
<span class="n">X_test</span> <span class="o">=</span> <span class="n">sc_X</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">classifier</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;euclidean&#39;</span><span class="p">)</span> 
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span> 
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span> 
<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy Score: &quot;</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;F1 Score: &quot;</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy Score:  0.7080536912751678
F1 Score:  0.6789667896678967
Confusion Matrix: 
 [[119  35]
 [ 52  92]]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\saura\anaconda3\lib\site-packages\sklearn\neighbors\_classification.py:228: FutureWarning: Unlike other reduction functions (e.g. `skew`, `kurtosis`), the default behavior of `mode` typically preserves the axis it acts along. In SciPy 1.11.0, this behavior will change: the default value of `keepdims` will become False, the `axis` over which the statistic is taken will be eliminated, and the value None will no longer be accepted. Set `keepdims` to True or False to avoid this warning.
  mode, _ = stats.mode(_y[neigh_ind, k], axis=1)
</pre></div>
</div>
</div>
</div>
<p>The second model we run is a Support Vector Machine Classification (SVC). This classifier finds a hyper plane in an n-dimensional (where n is the number of features) plane that distincly classifies the data points. While there could be multiple hyperplanes, the SCV model chooses the hyperplane that maximizes the distance ebtween the data points of both classes. For more information on the SCV model, refer <a class="reference external" href="https://towardsdatascience.com/support-vector-machine-introduction-to-machine-learning-algorithms-934a444fca47">here</a>.</p>
<p>Our accuracy score for the SVC model is ~78.85% which is better much better than our KNN classifier. Additionally, the f1 score is also very high for the SCV model, which is even higher than the accuracy score. This means the model has a higher weighted average of precision and recall. As shown by the confusion matrix, the model only has ~39 False Negatives and ~24 False Positives.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#use svm model</span>
<span class="n">svm_model</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">()</span> 
<span class="n">svm_model</span> <span class="o">=</span> <span class="n">svm_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span> 
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">svm_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span> 
<span class="c1">#print accuracy score based on test and prediction</span>
<span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy Score: &quot;</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;F1 Score: &quot;</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy Score:  0.7885906040268457
F1 Score:  0.7920792079207922
Confusion Matrix: 
 [[115  39]
 [ 24 120]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="random-forest-classifier-a-class-anchor-id-rfc-a">
<h4>Random Forest Classifier  <a class="anchor" id="rfc"></a><a class="headerlink" href="#random-forest-classifier-a-class-anchor-id-rfc-a" title="Permalink to this heading">#</a></h4>
<p>The third classification model we run is a <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html">Random Forest Classifier</a>. The random forest is a classification algorithm consisting of many decisions trees. It uses bagging and feature randomness when building each individual tree to try to create an uncorrelated forest of trees whose prediction by committee is more accurate than that of any individual tree.</p>
<p>The accuracy score for the Random Forest Classifier is an ~81.67%, which is a higher accuracy score than the aforementioned two models. Because the accuracy score can be so varied for Random Forest, we average the accuracy and f1 scores over 15 different runs to find the mean scores. This is a better representation of the actual scores of the model, rather than simply running the model once, as Random Forest can have different scores for different runs due to the randomness of the model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="n">f1</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="n">n</span> <span class="o">=</span> <span class="mi">15</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="c1">#train test split</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>
    <span class="n">rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="c1">#print out accuracy score</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">+</span>  <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">accuracy</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy: &quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;F1 Score: &quot;</span><span class="p">,</span> <span class="n">f1</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy:  0.8102908277404921
F1 Score:  0.794568509556114
</pre></div>
</div>
</div>
</div>
</section>
<section id="logistic-regression-classification-a-class-anchor-id-logistic-a">
<h4>Logistic Regression Classification  <a class="anchor" id="logistic"></a><a class="headerlink" href="#logistic-regression-classification-a-class-anchor-id-logistic-a" title="Permalink to this heading">#</a></h4>
<p>The fourth and final model we run is a Logistic Regression Classification. <a class="reference external" href="https://towardsdatascience.com/logistic-regression-detailed-overview-46c4da4303bc">Logistic Regression</a>, despite its name, is a classification model. In its simplest form, it models a binary output. Examples given by <a class="reference external" href="https://towardsdatascience.com/logistic-regression-detailed-overview-46c4da4303bc">Saishruthi Swaminathan of TowardsDataScience</a>  are, whether an email is spam (0) or not (1), or whether a tumor is malignant (0) or not (1). Logistic Regression is a transformation of linear regression that uses the <a class="reference external" href="https://www.sciencedirect.com/topics/computer-science/sigmoid-function">sigmoid function</a>
, a function that lies strictly between 0 and 1. The output of Logistic Regression is the probability of each binary output.</p>
<p>Our accuracy score for the Logistic Regression Classification is ~56.71%, which is moderately high for our data. The f1 score is similar, at about 57.7%. This shows that the Logistic Regression Classification is the worst classifier out of all the ones we tested, as it has the lowest accuracy score and the lowest f1 score. Additionally, the confusion matrix shows that it misclassifed ~89 as False Positives and ~40 as False Negatives.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#create logistic regression model and fit on the data</span>
<span class="n">lg_model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span> 
<span class="n">lg_model</span> <span class="o">=</span> <span class="n">lg_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span> 
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">lg_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span> 
<span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy Score: &quot;</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;F1 Score: &quot;</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy Score:  0.5067114093959731
F1 Score:  0.5180327868852459
Confusion Matrix: 
 [[ 72 110]
 [ 37  79]]
</pre></div>
</div>
</div>
</div>
<p>Now that we’ve shown you how different classification algorithms work to predict a hit movie, lets switch gears to talk about building a movie recommendation system using <a class="reference external" href="https://aws.amazon.com/what-is/nlp/#:~:text=Natural%20language%20processing%20(NLP)%20is,manipulate%2C%20and%20comprehend%20human%20language.">Natural Lanuguage Processing</a>.</p>
</section>
<section id="movie-recommender-a-class-anchor-id-movierec-a">
<h4>Movie Recommender  <a class="anchor" id="movieRec"></a><a class="headerlink" href="#movie-recommender-a-class-anchor-id-movierec-a" title="Permalink to this heading">#</a></h4>
<p>In this section, we will construct a method to find out which movie the user should watch after they have inputed a movie that they like. Our dataset contains various movies with their corresponding details such as plot, actors, and directors. However, this information may not be the most useful to a user seeking recommendations. Therefore, in the first part of our movie recommender system, we aim to provide the user with a way to find movies similar to the one they already enjoy. This basic form of recommendation is similar to how popular streaming sites like Netflix, HBO, and Hulu recommend movies to their users. Our approach involves selecting a movie from our database and using cosine similarity to compare its plot and genre with other movies in the dataset to identify similar movies that the user may like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics.pairwise</span> <span class="kn">import</span> <span class="n">cosine_similarity</span><span class="p">,</span> <span class="n">euclidean_distances</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#function that combines plot/genre</span>
<span class="k">def</span> <span class="nf">combine_info</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;Plot&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;Genre&quot;</span><span class="p">])</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">string</span><span class="o">.</span><span class="n">punctuation</span><span class="p">))</span>
    <span class="n">stop_words</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">))</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">filtered_words</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span> <span class="k">if</span> <span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stop_words</span><span class="p">]</span>
    <span class="n">filtered_text</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filtered_words</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">filtered_text</span>

<span class="c1">#try out on Insideous</span>
<span class="n">data2</span><span class="p">[</span><span class="s2">&quot;combined&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">combine_info</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">data2</span><span class="p">[</span><span class="n">data2</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Insidious&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>index</th>
      <th>Title</th>
      <th>Genre</th>
      <th>Actors</th>
      <th>Director</th>
      <th>Plot</th>
      <th>Country</th>
      <th>Language</th>
      <th>imdbRating</th>
      <th>...</th>
      <th>imdbVotes</th>
      <th>Metascore</th>
      <th>month</th>
      <th>day</th>
      <th>year</th>
      <th>Production Company</th>
      <th>Rated</th>
      <th>Budget</th>
      <th>Keywords</th>
      <th>combined</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>44</th>
      <td>44</td>
      <td>44</td>
      <td>Insidious</td>
      <td>Horror, Mystery, Thriller</td>
      <td>Patrick Wilson, Rose Byrne, Ty Simpkins</td>
      <td>James Wan</td>
      <td>A family looks to prevent evil spirits from tr...</td>
      <td>United States, Canada</td>
      <td>English</td>
      <td>6.8</td>
      <td>...</td>
      <td>317,623</td>
      <td>52.0</td>
      <td>april</td>
      <td>1.0</td>
      <td>2011</td>
      <td>FilmDistrict / Haunted Movies / Stage 6 Films ...</td>
      <td>PG-13</td>
      <td>1500000.0</td>
      <td>['medium', 'evil spirit', 'house warming', 'af...</td>
      <td>family looks prevent evil spirits trapping com...</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 21 columns</p>
</div></div></div>
</div>
<p>This code enhances our movie dataset by adding a new ‘combined’ column to ‘data’ that concatenates the ‘Plot’ and ‘Genre’ columns for each row. To improve the accuracy of our similarity score, we utilize the NLTK library to remove punctuation and stopwords from the combined text. Our aim is to identify movies that are similar to Insidious; thus, we start by selecting the row that corresponds to this movie.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#tfid vectorizer to calculate scores</span>
<span class="n">tfidf</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">max_features</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">feature</span> <span class="o">=</span> <span class="n">tfidf</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data2</span><span class="p">[</span><span class="s2">&quot;combined&quot;</span><span class="p">])</span>
<span class="n">movie_title</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data2</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">data2</span><span class="p">[</span><span class="s2">&quot;Title&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>This code uses TfidfVectorizer to calculate the TF-IDF scores for the ‘combined’ column (which contains the concatenated plot and genre for each movie) of the movie dataset ‘data’. The resulting feature matrix is assigned to ‘feature’. We then create a new series with just the indexes of the movies as well as the title for retrieving the similar titles later on.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#cosine similary using Insideous</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">movie_title</span><span class="p">[</span><span class="s2">&quot;Insidious&quot;</span><span class="p">]</span>
<span class="n">vector</span> <span class="o">=</span> <span class="n">feature</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">reccomendations</span> <span class="o">=</span> <span class="n">cosine_similarity</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="n">feature</span><span class="p">)</span>
<span class="n">reccomendations</span> <span class="o">=</span> <span class="n">reccomendations</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>This code generates movie recommendations by comparing the feature vector for Insidious to the feature vectors of all other movies in the dataset using cosine similarity. It then plots the resulting similarity scores.
Specifically, the code finds the index of the movie Insidious and retrieves its feature vector from the Tfidf-transformed data. It then calculates the cosine similarity between the movie and all other movies in the dataset, generating an array of similarity scores.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#plot similarity graph</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">reccomendations</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Movie Recommendations for &#39;Insidious&#39;&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Movie Index&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Similarity Score&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4453e413555349d1a8cfa7d655aca4324ff46fba396ca6cb46f8354782626cda.png" src="_images/4453e413555349d1a8cfa7d655aca4324ff46fba396ca6cb46f8354782626cda.png" />
</div>
</div>
<p>The resulting plot of the similarity scores generated by the code shows that the movie with a similarity score of 1.0 is the input movie, Insidious. This indicates that the algorithm has successfully identified the movie as being identical to itself. If we look at the rest of the similarity scores on the plot, we can see that the next most similar movie to Insidious has a score of 0.3. This suggests that the algorithm has identified a movie with similar genre and plot elements to Insidious, although not as closely related as the movie itself.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#list out the top 5 recs</span>
<span class="p">(</span><span class="o">-</span><span class="n">reccomendations</span><span class="p">)</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
<span class="n">final_recs</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">reccomendations</span><span class="p">)</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[:</span><span class="mi">5</span><span class="p">]</span>
<span class="n">data2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_recs</span><span class="p">][</span><span class="s2">&quot;Title&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>44                  Insidious
685      Insidious: Chapter 2
165     Paranormal Activity 3
2155       Brahms: The Boy II
1792      The Little Stranger
Name: Title, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Finally, the code identifies the movies with the highest similarity scores by sorting the similarity score array. The top five movies with the most similar genre and plot elements to Insidious are then listed.</p>
<p>Overall, while cosine similarity is a useful metric to identify similarities between movies based on their plot and genre, it has its limitations. Movies may have similar plots and genres but differ in other aspects such as director, actors, release date, and language, among others. Incorporating these factors could lead to a more accurate similarity score and ultimately better recommendations.</p>
</section>
<section id="movie-recommender-ii-a-class-anchor-id-movierec2-a">
<h4>Movie Recommender II  <a class="anchor" id="movieRec2"></a><a class="headerlink" href="#movie-recommender-ii-a-class-anchor-id-movierec2-a" title="Permalink to this heading">#</a></h4>
<p>In this section of the movie recommendation system, our objective is to generate a description for a movie that is similar to its original summary using Natural Language Processing techniques. We will use Markov Models as the underlying principle to generate the summary. After generating the summary, we will compare its similarity with the summary scraped from Wikipedia for the same movie using cosine similarity to evaluate the effectiveness of our model.</p>
<p>Before delving into the coding aspect, it’s crucial to comprehend the Markov Models, how it relates to the subject learned in class, and why we are utilizing it.</p>
<p>In class, we were introduced to the Naive Bayes model, which is a probabilistic model based on Bayes’ theorem. This model calculates the probability of an event given some information, also known as conditional probability. Although Markov Models and Bayes’ theorem are related, Markov Models are grounded on the underlying Markov assumption, which is based on the concept of modeling sequences where each state is only reliant on the preceding state.</p>
<p>The Markov model’s formal notation is P(x at time t | x at time t - 1, x at time t-2, …) = p(x at time t | x at time t-1). We plan to utilize Markov Models to predict the most probable word to appear next, given the previous one. If we represent each word as a state (s), P((s at time t) = y|(s at time t-1) = z) would be our objective.</p>
<p>Programmatically, we will store the probabilities in a 2-D matrix, where Xyz = P((s at time t) = y|(s at time t-1) = z). Since we are predicting the next word based on the current word, we need to define something for the initial word since it doesn’t have a previous word to rely on.</p>
<p>Therefore, we define the initial state to be the number of times each sequence began with state x divided by the total number of sequences in our dataset. Our Xyz would then be the number of times we transitioned from state y to state z divided by the total number of times we were in state y.</p>
<p>For instance, let’s consider the phrase “CMSC320 Rocks.” We are interested in the probability of seeing the word “Rocks” following the word “CMSC320.” Our Xyz would be the number of times we observe the sequence “CMSC320 Rocks” divided by the number of times we observe the sequence “CMSC320.”</p>
<p>Generally, the more conditionals you add to Xyz = P((s at time t) = y|(s at time t-1) = z), the more accurate your predictions will be. Therefore, we plan to enhance our model by adding one more conditional or creating a “Second Order Markov Model” by adding one more, so Xyza = P(st = a| st-1 = z, st-2 = y).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#imports for this section</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">nltk</span>
<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics.pairwise</span> <span class="kn">import</span> <span class="n">cosine_similarity</span><span class="p">,</span> <span class="n">euclidean_distances</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_absolute_error</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MultiLabelBinarizer</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;stopwords&#39;</span><span class="p">)</span>

<span class="c1">#request the plot of the avengers film</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://en.wikipedia.org/wiki/The_Avengers_(2012_film)&quot;</span><span class="p">)</span>
<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
<span class="n">txt</span> <span class="o">=</span> <span class="p">[</span><span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">getText</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">&#39;&quot;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">)]</span>
<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[nltk_data] Downloading package stopwords to
[nltk_data]     C:\Users\saura\AppData\Roaming\nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
</pre></div>
</div>
</div>
</div>
<p>First we have to to pick a movie and scrape the summary associated with it. We are going to pick The avengers movie as the movie whose summary we are going to compare. This code retrieves the Wikipedia page for the 2012 film “The Avengers” using the requests library. Then it uses the BeautifulSoup library to parse the HTML text of the page and extract the text of the 4th to 7th paragraphs of the article. The reason for using only the text between the 4th and 7th paragraphs is that the full summary on the Wikipedia page may be too long and contain irrelevant information for the movie recommendation system. By limiting the text to these specific paragraphs, we can focus on the most relevant and concise summary of the movie. The resulting text is then cleaned up and the paragraphs are then joined together into a single string variable called “text”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">initial</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># stores initial state destribution</span>
<span class="n">first_order</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># first order transition probabilities but only for the second order</span>
<span class="n">second_order</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1">#stores second_order probabilities</span>
</pre></div>
</div>
</div>
</div>
<p>In this section of code, we are initializing three dictionaries, namely, the initial state dictionary, first_order dictionary, and second_order dictionary. These dictionaries are used for generating text using the Markov Model. The first-order dictionary is used to compute the second-order dictionary. The dictionaries will later store the count of each token and the probability of transitioning from one token to another.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">txt</span><span class="p">:</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">.</span><span class="n">punctuation</span><span class="p">))</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="c1">#This line removes all punctuation from a given string using Python&#39;s built-in translate() function and the string.punctuation module.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)):</span>
    <span class="c1"># t would be the first word</span>
        <span class="n">word1</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># first word so update initial state distribution</span>
          <span class="n">initial</span><span class="p">[</span><span class="n">word1</span><span class="p">]</span> <span class="o">=</span> <span class="n">initial</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">word1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
        <span class="c1">#not in initial state distribution</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
       <span class="c1">#since it is not first state and second order we need to grab previous word</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">second_order</span><span class="o">.</span><span class="n">setdefault</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">word1</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;STOP&#39;</span><span class="p">)</span>

                <span class="c1"># measure probability of ending the line</span>
                <span class="c1">#if we are at the end of sentence we create a fake word to let us know when the line would end</span>
                <span class="c1">#still pass the last word, </span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># measure distribution of second word given only first word</span>
        
        <span class="c1">#looking at second word in statement so update the first_order which will be used for second_order</span>
                <span class="n">first_order</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word1</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
        <span class="c1">#not looking at the first or second word so we have at least two words to look at</span>
                <span class="n">word2</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">second_order</span><span class="o">.</span><span class="n">setdefault</span><span class="p">((</span><span class="n">word2</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This code processes a list of text lines by cleaning and tokenizing each line, and then uses the resulting tokens to update various dictionaries. The initial dictionary keeps track of the first word in each line, while the first_order dictionary tracks the probability of the second word given the first word. The second_order dictionary tracks the probability of the third word given the previous two words. Additionally, if the current token is the last one in the line, a special “END” token is added to the second_order dictionary to signify the end of the line. The dictionaries are updated using the dicionary’s inbuilt setdefault function, which simply adds the given value to the list of values associated with the given key in the dictionary. Specifically the purpose of that [dictionary].setdefault line is to use a dictionary with a key and a corresponding value that is a list of possible next words. For example, if we have the phrases “I love school, I love cars, I love science”, we can translate it into the dictionary {“I love”: [“school”, “cars”, “science”]}. The goal is to later convert this into probabilities of each word appearing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#initial total has all the counts as of now so we normalize it</span>
<span class="n">initial_total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">initial</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">initial</span><span class="p">:</span>
    <span class="n">initial</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">/=</span> <span class="n">initial_total</span>
</pre></div>
</div>
</div>
</div>
<p>This code block performs normalization on the initial state distribution by dividing each count by the total count of all the initial words. The initial state distribution is a probability distribution of the first word of each line in the text corpus. By dividing each count by the total count, we convert the counts into probabilities that sum to 1, which represents the likelihood of each initial word occurring at the beginning of a line in the text corpus.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">prob</span><span class="p">(</span><span class="n">words</span><span class="p">):</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="c1"># Iteration</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
        <span class="c1"># increments key in dictionary by one</span>
        <span class="n">prob</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>  
    <span class="c1"># Normalizing the values</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="p">{</span><span class="n">item</span><span class="p">:</span> <span class="n">count</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">prob</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    <span class="k">return</span> <span class="n">prob</span>
</pre></div>
</div>
</div>
</div>
<p>This code defines a function called “prob” that takes in a list as an argument. The function then creates an empty dictionary to hold the probabilities of each item in the list. It iterates over each item in the list, and if the item is not already in the dictionary, it adds it with a count of 1. If the item is already in the dictionary, it increments its count by 1. After counting all the items, the function then normalizes the counts to obtain the probabilities of each item, by dividing each count by the total length of the list. Finally, it returns the resulting probability dictionary.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_order</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="n">prob</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">first_order</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<span class="n">second_order</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="n">prob</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">second_order</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</pre></div>
</div>
</div>
</div>
<p>This section of code calculates the probabilities of the items in the original dictionaries and assigns the probabilities to the keys for both first_order and second_order dictionaries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>

<span class="c1">#generate random word</span>
<span class="k">def</span> <span class="nf">random_word</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">t</span>
        <span class="n">x</span> <span class="o">-=</span> <span class="n">p</span>
</pre></div>
</div>
</div>
</div>
<p>The  function takes a dictionary of probabilities and returns a word based on a random sample. It iterates over the items in the dictionary, keeping a cumulative sum of their probabilities. If the random number is less than the cumulative sum, it returns the corresponding word. If the loop completes without finding a word, it raises a ValueError.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#function for creating the summary</span>
<span class="k">def</span> <span class="nf">create_summary</span><span class="p">():</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="c1"># generate 4 lines</span>
        <span class="n">sentence</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Initial state word</span>
        <span class="n">first</span> <span class="o">=</span> <span class="n">random_word</span><span class="p">(</span><span class="n">initial</span><span class="p">)</span>
        <span class="n">sentence</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">first</span><span class="p">)</span>

        <span class="c1"># first_order word</span>
        <span class="n">second</span> <span class="o">=</span> <span class="n">random_word</span><span class="p">(</span><span class="n">first_order</span><span class="p">[</span><span class="n">first</span><span class="p">])</span>
        <span class="n">sentence</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">second</span><span class="p">)</span>

    <span class="c1"># Continuing to do second_order words until the end</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">third</span> <span class="o">=</span> <span class="n">random_word</span><span class="p">(</span><span class="n">second_order</span><span class="p">[(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">)])</span>
            <span class="k">if</span> <span class="n">third</span> <span class="o">==</span> <span class="s1">&#39;STOP&#39;</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">sentence</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">third</span><span class="p">)</span>
            <span class="n">first</span> <span class="o">=</span> <span class="n">second</span>
            <span class="n">second</span> <span class="o">=</span> <span class="n">third</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sentence</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</div>
<p>In this function, a list of 4 sentences is generated using a first-order Markov chain. The initial word of each sentence is always “The”, and subsequent words are chosen probabilistically based on the previous word in the chain using the random_word function. The process continues until the word “FINAL” is generated, at which point the sentence is complete. The resulting sentences are returned as a list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#test cases</span>
<span class="n">sample_text</span> <span class="o">=</span> <span class="n">create_summary</span><span class="p">()</span>
<span class="n">sample_text</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sample_text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let us see what we generated compared to what we scraped.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Generated Text: </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">sample_text</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original Text: </span><span class="se">\n</span><span class="s2">&quot;</span>  <span class="o">+</span>  <span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generated Text: 
the asgardian loki encounters the other promises loki an army with which he can subjugate earth nick fury director of the espionage agency shield arrives at a remote research facility where physicist dr erik selvig is leading a team experimenting on the tesseract and uses his scepter to enslave selvig and other agents including clint barton to aid him in response fury reactivates the avengers initiative agent natasha romanoff heads to kolkata to recruit dr bruce banner to transform into the hulk rally in defense of new york city and together the avengers become divided over how to approach loki and the tesseract and a wormhole allowing loki to reach earth loki steals the tesseract through its gamma radiation emissions fury approaches steve rogers to retrieve the tesseract to develop powerful weapons as a team experimenting on the tesseract and uses his scepter to enslave selvig and other agents including clint barton to aid him the asgardian loki encounters the other the leader of an extraterrestrial race known as the chitauri in exchange for retrieving the tesseractc a powerful energy source of unknown potential the other promises loki an army with which he can subjugate earth nick fury director of the espionage agency shield arrives at a remote research facility where physicist dr erik selvig is leading a team experimenting on the tesseract the tesseract and uses his scepter to close the wormhole in the aftermath thor returns with loki and the tesseract to asgard stark and rogers intervene and loki is taken to shields flying aircraft carrier the helicarrier where he is imprisoned the avengers become divided over how to approach loki and the tesseract through its gamma radiation emissions fury approaches steve rogers to retrieve the tesseract to asgard stark and rogers intervene and loki is in stuttgart where barton steals the tesseract through its gamma radiation emissions fury approaches steve rogers to retrieve the tesseract and agent phil coulson visits tony stark to have him check selvigs research loki is in stuttgart where barton steals the tesseract suddenly activates and opens a wormhole above stark tower to the generator where selvig freed from lokis mind control reveals that lokis scepter can shut down the generator where selvig freed from lokis mind control loki escapes after killing coulson and fury uses coulsons death to motivate the avengers become divided over how to approach loki and the revelation that shield plans to harness the tesseract suddenly activates and opens a wormhole allowing loki to reach earth loki steals the iridium needed to stabilize the tesseracts power leading to a confrontation with rogers stark romanoff barton thor and the hulk beats loki into submission romanoff makes her way to the chitauri fleet in space launching his invasion
Original Text: 
The Asgardian Loki encounters the Other, the leader of an extraterrestrial race known as the Chitauri. In exchange for retrieving the Tesseract,[c] a powerful energy source of unknown potential, the Other promises Loki an army with which he can subjugate Earth. Nick Fury, director of the espionage agency S.H.I.E.L.D., arrives at a remote research facility, where physicist Dr. Erik Selvig is leading a team experimenting on the Tesseract. The Tesseract suddenly activates and opens a wormhole, allowing Loki to reach Earth. Loki steals the Tesseract and uses his scepter to enslave Selvig and other agents, including Clint Barton, to aid him.
 In response, Fury reactivates the &quot;Avengers Initiative&quot;. Agent Natasha Romanoff heads to Kolkata to recruit Dr. Bruce Banner to trace the Tesseract through its gamma radiation emissions. Fury approaches Steve Rogers to retrieve the Tesseract, and Agent Phil Coulson visits Tony Stark to have him check Selvig&#39;s research. Loki is in Stuttgart, where Barton steals the iridium needed to stabilize the Tesseract&#39;s power, leading to a confrontation with Rogers, Stark, and Romanoff that ends with Loki&#39;s surrender. While Loki gets escorted to S.H.I.E.L.D., his adoptive brother Thor arrives and frees him, hoping to convince him to abandon his plan and return to Asgard. Stark and Rogers intervene and Loki is taken to S.H.I.E.L.D.&#39;s flying aircraft carrier, the Helicarrier, where he is imprisoned.
 The Avengers become divided over how to approach Loki and the revelation that S.H.I.E.L.D. plans to harness the Tesseract to develop powerful weapons as a deterrent against hostile extraterrestrials. As they argue, Loki&#39;s agents attack the Helicarrier, and the stress causes Banner to transform into the Hulk. Stark and Rogers work to restart the damaged engine, and Thor attempts to stop the Hulk&#39;s rampage. Romanoff knocks Barton unconscious, breaking Loki&#39;s mind control. Loki escapes after killing Coulson and Fury uses Coulson&#39;s death to motivate the Avengers into working as a team. Loki uses the Tesseract and a wormhole generator Selvig built to open a wormhole above Stark Tower to the Chitauri fleet in space, launching his invasion.
 Rogers, Stark, Romanoff, Barton, Thor, and the Hulk rally in defense of New York City, and together the Avengers battle the Chitauri. The Hulk beats Loki into submission. Romanoff makes her way to the generator, where Selvig, freed from Loki&#39;s mind control, reveals that Loki&#39;s scepter can shut down the generator. Fury&#39;s superiors from the World Security Council attempt to end the invasion by launching a nuclear missile at Midtown Manhattan. Stark intercepts the missile and takes it through the wormhole toward the Chitauri fleet. The missile detonates, destroying the Chitauri mothership and disabling their forces on Earth. Stark&#39;s suit loses power and he goes into freefall, but the Hulk saves him, while Romanoff uses Loki&#39;s scepter to close the wormhole. In the aftermath, Thor returns with Loki and the Tesseract to Asgard, where Loki will face their justice.
</pre></div>
</div>
</div>
</div>
<p>There seems to be slight differences within the original and generated texts. To effectively compare both texts it is neccessary to get rid of stopwords. Let us plot the word counts of both texts to see why.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="c1">#uses the sample_text and title to plot word frequency</span>
<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">sample_text</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="n">sentence_words</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">words</span> <span class="ow">in</span> <span class="n">sample_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">):</span>
        <span class="n">sentence_words</span><span class="p">[</span><span class="n">words</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">sentence_words</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">sentence_words</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="n">sentence_words</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sentence_words</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sentence_words</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#7F7FFF&#39;</span><span class="p">,</span> <span class="s1">&#39;#7FFF7F&#39;</span><span class="p">,</span> <span class="s1">&#39;#FF7F7F&#39;</span><span class="p">,</span> <span class="s1">&#39;#FFFF7F&#39;</span><span class="p">,</span> <span class="s1">&#39;#7FFFFF&#39;</span><span class="p">,</span> <span class="s1">&#39;#FF7FFF&#39;</span><span class="p">,</span> <span class="s1">&#39;#7F7F7F&#39;</span><span class="p">,</span> <span class="s1">&#39;#FFBF7F&#39;</span><span class="p">,</span> <span class="s1">&#39;#BF7FFF&#39;</span><span class="p">,</span> <span class="s1">&#39;#7FFFBF&#39;</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">values</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="n">tick_label</span><span class="o">=</span><span class="n">names</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Word&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plot</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">txt</span><span class="p">),</span> <span class="s2">&quot;Word frequency in Scraped Data&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">sample_text</span><span class="p">,</span> <span class="s2">&quot;Word frequency in Generated Data&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fff463a3cbb9a377a8c9299cc0d324fc77a2f60d158e96ad402da06ed89ade21.png" src="_images/fff463a3cbb9a377a8c9299cc0d324fc77a2f60d158e96ad402da06ed89ade21.png" />
<img alt="_images/0845e117d8796439d5ad4c4e2e5c60187ba78a4729fc6a6c401895bd25687289.png" src="_images/0845e117d8796439d5ad4c4e2e5c60187ba78a4729fc6a6c401895bd25687289.png" />
</div>
</div>
<p>As seen when we display the words in the generated paragraph, “the”, “to”, “and”, “a” are among the most common words in both summaries and thus might skew the similarity results.</p>
<p>In order for us to compare with our generated text with our original text let us further clean both these texts by getting rid of the stopwords</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nltk</span>
<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;punkt&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>
<span class="kn">from</span> <span class="nn">nltk.tokenize</span> <span class="kn">import</span> <span class="n">word_tokenize</span>
<span class="n">stop_words</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s2">&quot;english&quot;</span><span class="p">))</span>

<span class="c1">#cleans the data so that words such as &quot;the&quot; are not used</span>
<span class="k">def</span> <span class="nf">cleaning2</span><span class="p">(</span><span class="n">two</span><span class="p">):</span>
    <span class="n">final_descrip</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">descrip</span> <span class="ow">in</span> <span class="n">two</span><span class="p">:</span>
        <span class="n">descrip</span> <span class="o">=</span> <span class="n">descrip</span><span class="o">.</span><span class="n">translate</span> <span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">.</span><span class="n">punctuation</span><span class="p">))</span>
        <span class="n">tokens</span> <span class="o">=</span> <span class="n">word_tokenize</span><span class="p">(</span><span class="n">descrip</span><span class="p">)</span>
        <span class="n">sentence</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">tokens</span> <span class="k">if</span> <span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stop_words</span><span class="p">]</span>
        <span class="n">final</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stop_words</span><span class="p">:</span>
                <span class="n">final</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> 
        <span class="n">final_descrip</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">final</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">final_descrip</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[nltk_data] Downloading package punkt to
[nltk_data]     C:\Users\saura\AppData\Roaming\nltk_data...
[nltk_data]   Package punkt is already up-to-date!
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">orig_text</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cleaning2</span><span class="p">(</span><span class="n">txt</span><span class="p">))</span>
<span class="n">generated_text</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">cleaning2</span><span class="p">([</span><span class="n">sample_text</span><span class="p">]))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">orig_text</span><span class="p">,</span> <span class="s2">&quot;Word frequency in Scraped Data&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">generated_text</span><span class="p">,</span> <span class="s2">&quot;Word frequency in Generated Data&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/80cb3872fe804f5ebf665c939379540df7aa421db7c1629eaae527de80488cec.png" src="_images/80cb3872fe804f5ebf665c939379540df7aa421db7c1629eaae527de80488cec.png" />
<img alt="_images/7f42917de1ea80c9d093933eaa38b88eb1d338dc76a0f5135eced8d7c853cd36.png" src="_images/7f42917de1ea80c9d093933eaa38b88eb1d338dc76a0f5135eced8d7c853cd36.png" />
</div>
</div>
<p>Here we call out cleaning function on both the original text as well as the generated text to get rid of stopwords and punctation that might affect the cosine similarity process. Now the cosine similarity will be able to more accurately compare the similarity between both texts.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vectorizer</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">()</span>
<span class="n">tfidf</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">([</span><span class="n">orig_text</span><span class="p">,</span> <span class="n">generated_text</span><span class="p">])</span>
<span class="n">cosine_sim</span> <span class="o">=</span> <span class="p">(</span><span class="n">cosine_similarity</span><span class="p">(</span><span class="n">tfidf</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tfidf</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cosine_sim</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8078183532498256
</pre></div>
</div>
</div>
</div>
<p>A cosine similarity score of ~0.80 indicates a relatively high level of similarity between the summary of the movie obtained online and the summary generated using Markov models.However, it is to be noted that the generated text isn’t the same every time it is ran. In fact, after running this multiple times the lowest similartiy I got for the same text was 0.53.</p>
<p>Thus, it can be said that there is a lot more that goes into text generated. Markov Models work by picking the sequence of words that result in the highest probability. Because of this, if one were to read the generated text, some sentences are not coherent and because of this some sentences dont make since. However, Markov Models serve as a great way to introduce the idea of text generation.</p>
</section>
</section>
<section id="interpretation-insight-policy-decision-a-class-anchor-id-conclusion-a">
<h3>Interpretation: Insight &amp; Policy Decision  <a class="anchor" id="conclusion"></a><a class="headerlink" href="#interpretation-insight-policy-decision-a-class-anchor-id-conclusion-a" title="Permalink to this heading">#</a></h3>
<p>Ultimately, we aimed to classify which movies were a “hit” based off their imdbRating, and were quite successful. In comparing the four different classifiers we used, RandomForestClassification had the highest accuracy score with above 81%. Additionally, the f1 score for the RandomForestClassification was the highest out of all the models, thus implying it had a high precision rate as well. In the future we hope to be able to add more features to our classifier, and fine tune our parameters to achieve a higher accuracy score.</p>
<p>The recommender has identified movies with the highest similarity using cosine similarity. The movies with the most similar plot/genre are shown to the user. Something to think about is that movies may have similar plots and genres but differ in other aspects such as director, actors, release date, and language, among others. Incorporating these factors could lead to a more accurate similarity score and ultimately better recommendations.</p>
<p>As for the recommender part II, The cosine similarity score of around 0.80 indicates that there is a relatively high level of similarity between the movie summary obtained online and the summary generated using Markov models. However, it should be noted that the generated text is not the same every time it is run. In fact, when the same text was run multiple times, the lowest similarity score obtained was 0.53. This suggests that text generation involves a lot more than just using Markov models.</p>
<p>Markov models generate text by selecting the sequence of words that have the highest probability. As a result, some sentences in the generated text may not be coherent, and some may not make sense when read. Nevertheless, Markov models provide a useful way to introduce the concept of text generation.</p>
<p>Now, we’ve classified whether a movie will be well recieved or now and we offer you our very own (free of cost) movie recommender for you can keep watching movies similar to the ones you love and walk you through how you can build one of your own!</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-a-class-anchor-id-intro-a">Introduction <a class="anchor" id="intro"></a></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-collection-data-cleaning-a-class-anchor-id-datacollectandclean-a">Data Collection/Data Cleaning <a class="anchor" id="dataCollectAndClean"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#imports-for-data-collection-a-class-anchor-id-importdc-a">Imports for Data Collection  <a class="anchor" id="importDC"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-of-data-collection-a-class-anchor-id-overviewdata-a">Overview of Data Collection  <a class="anchor" id="overviewData"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#webscraping-from-wikipedia-a-class-anchor-id-wikiscrape-a">Webscraping from Wikipedia <a class="anchor" id="wikiScrape"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pulling-from-the-omdb-api-a-class-anchor-id-omdbapi-a">Pulling from the OMDB API  <a class="anchor" id="omdbAPI"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-our-appended-dataframe">Creating our Appended DataFrame</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleaning-organizing-relavent-information-addressing-missing-data-a-class-anchor-id-cleanprocess-a">Data Cleaning: Organizing Relavent Information &amp; Addressing Missing Data  <a class="anchor" id="cleanProcess"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#organizing-relavent-information">Organizing Relavent Information</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-data">Missing Data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-tmdb-api-a-class-anchor-id-tmdbapi-a">Using the TMDB API  <a class="anchor" id="tmdbAPI"></a></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exploratory-data-analysis-and-visualization-a-class-anchor-id-dataviz-a">Exploratory Data Analysis and Visualization  <a class="anchor" id="dataViz"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-visualizations-a-class-anchor-id-initialviz-a">Initial Visualizations  <a class="anchor" id="initialViz"></a></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-analysis-hypothesis-testing-ml-a-class-anchor-id-ml-a">Model: Analysis, Hypothesis Testing, &amp; ML  <a class="anchor" id="ml"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#preliminary-exploration-of-data-for-the-model-a-class-anchor-id-preliminary-a">Preliminary Exploration of Data for the Model  <a class="anchor" id="preliminary"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-importance-a-class-anchor-id-feature-a">Feature Importance  <a class="anchor" id="feature"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#k-nearest-neighbors-a-class-anchor-id-knn-a">K Nearest Neighbors  <a class="anchor" id="knn"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest-classifier-a-class-anchor-id-rfc-a">Random Forest Classifier  <a class="anchor" id="rfc"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#logistic-regression-classification-a-class-anchor-id-logistic-a">Logistic Regression Classification  <a class="anchor" id="logistic"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#movie-recommender-a-class-anchor-id-movierec-a">Movie Recommender  <a class="anchor" id="movieRec"></a></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#movie-recommender-ii-a-class-anchor-id-movierec2-a">Movie Recommender II  <a class="anchor" id="movieRec2"></a></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation-insight-policy-decision-a-class-anchor-id-conclusion-a">Interpretation: Insight &amp; Policy Decision  <a class="anchor" id="conclusion"></a></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book community
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>